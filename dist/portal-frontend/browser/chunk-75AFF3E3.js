import{a as ne}from"./chunk-AKGTJQQS.js";import{b as ae}from"./chunk-VBOQVG3O.js";import{a as re,b as oe}from"./chunk-DEGAUCA6.js";import{n as ie}from"./chunk-U446ZUSE.js";import"./chunk-7XV6CRBL.js";import{a as ee,b as te}from"./chunk-LFBU7IBC.js";import"./chunk-6OSMVD66.js";import"./chunk-IAKHD2KQ.js";import"./chunk-KTZAFNHT.js";import"./chunk-L2YMTAJ4.js";import{e as K,f as U}from"./chunk-SQDM7FYD.js";import"./chunk-MUUDK5FO.js";import"./chunk-GS33KFGJ.js";import{q as Y,x as Z}from"./chunk-OHCSBWXS.js";import"./chunk-APKN3PFA.js";import"./chunk-X6GEXHSG.js";import{a as W,b as X}from"./chunk-MX4UQD2B.js";import"./chunk-X5B2VV3T.js";import"./chunk-ZTWDMVRM.js";import"./chunk-P7FDEGEE.js";import"./chunk-XSSXK7EZ.js";import"./chunk-PWTX4GCB.js";import{b as B,c as M,e as A,f as R,i as L,j as P,k as j,m as z,o as Q,p as $,q}from"./chunk-HXGQMCX4.js";import"./chunk-TDXTCVPJ.js";import"./chunk-WTM76CTQ.js";import{d as E,e as w}from"./chunk-AXYD25ST.js";import{e as G,i as J,n as x}from"./chunk-VBSZGXZN.js";import{$ as T,Db as D,Eb as O,Fb as F,Hb as u,Ib as V,Ob as S,Pb as k,Ta as p,Wa as N,Y as g,Za as H,da as I,db as y,ea as h,fa as _,fb as m,kb as C,ob as o,pb as a,qb as v,ub as b,wb as c,xb as d}from"./chunk-HOTPW52P.js";function de(r,n){if(r&1&&v(0,"app-error-input",6),r&2){let s=d();m("message",s.getErrorMessage("name",s.form))}}function ce(r,n){if(r&1&&v(0,"app-error-input",6),r&2){let s=d();m("message",s.getErrorMessage("description",s.form))}}function ue(r,n){if(r&1){let s=b();o(0,"p-button",10),c("onClick",function(){h(s);let t=d();return _(t.handleAccept())}),a(),o(1,"p-button",11),c("onClick",function(){h(s);let t=d();return t.modalData.response=null,_(t.handleClose.emit())}),a()}r&2&&(m("raised",!0)("rounded",!0),p(),m("raised",!0)("rounded",!0))}var se=(()=>{let n=class n{constructor(){this.fb=g(z),this.getErrorMessage=X,this.modalData={title:"",visible:!1,data:null,response:null},this.handleClose=new H,this.form=this.fb.group({id:[""],name:["",M.required],description:["",M.maxLength(255)]})}ngOnChanges(i){i.modalData&&(this.form.reset(),this.modalData.data&&this.form.patchValue(this.modalData.data))}handleAccept(){this.form.valid?(this.modalData.response=this.form.value,this.handleClose.emit()):Object.values(this.form.controls).forEach(i=>{i.invalid&&(i.markAsDirty(),i.updateValueAndValidity({onlySelf:!0}))})}};n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=T({type:n,selectors:[["app-outcome-type-form"]],inputs:{modalData:"modalData"},outputs:{handleClose:"handleClose"},standalone:!0,features:[I,S],decls:15,vars:9,consts:[["id","dialog","styleClass","w-10 md:w-30rem",3,"header","visible","modal","draggable","resizable","visibleChange","onHide"],[1,"pt-4","grid","row-gap-3","h-full",3,"formGroup"],[1,"col-12"],[1,"p-float-label"],["pInputText","","formControlName","name","id","name","type","text",1,"w-full"],["for","name"],[3,"message"],["pInputTextarea","","formControlName","description","id","description",1,"w-full",3,"rows"],["for","description"],["pTemplate","footer"],["label","Aceptar","severity","success",3,"raised","rounded","onClick"],["label","Cancelar","severity","danger",3,"raised","rounded","onClick"]],template:function(t,e){if(t&1&&(o(0,"p-dialog",0),c("visibleChange",function(f){return e.modalData.visible=f})("onHide",function(){return e.modalData.response=null,e.handleClose.emit()}),o(1,"form",1)(2,"div",2)(3,"span",3),v(4,"input",4),o(5,"label",5),u(6,"Nombre"),a()(),y(7,de,1,1,"app-error-input",6),a(),o(8,"div",2)(9,"span",3),v(10,"textarea",7),o(11,"label",8),u(12,"Descripci\xF3n"),a()(),y(13,ce,1,1,"app-error-input",6),a()(),y(14,ue,2,4,"ng-template",9),a()),t&2){let l,f;m("header",e.modalData.title)("visible",e.modalData.visible)("modal",!0)("draggable",!1)("resizable",!1),p(),m("formGroup",e.form),p(6),C(7,(l=e.form.get("name"))!=null&&l.dirty&&((l=e.form.get("name"))!=null&&l.invalid)?7:-1),p(3),m("rows",5),p(3),C(13,(f=e.form.get("description"))!=null&&f.dirty&&((f=e.form.get("description"))!=null&&f.invalid)?13:-1)}},dependencies:[U,K,x,Q,L,B,A,R,P,j,w,E,te,ee,q,$,W,ae]});let r=n;return r})();var fe=["container"],ge=["table"];function he(r,n){r&1&&(o(0,"tr")(1,"th"),u(2,"Nombre"),a(),o(3,"th"),u(4,"Descripci\xF3n"),a(),o(5,"th"),u(6,"Activo"),a(),o(7,"th",7),u(8,"Acciones"),a()())}function _e(r,n){if(r&1){let s=b();o(0,"p-button",12),c("onClick",function(){h(s);let t=d().$implicit,e=d();return _(e.onDeleteOutcomeType(t))}),a()}r&2&&m("rounded",!0)("raised",!0)}function ye(r,n){if(r&1){let s=b();o(0,"p-button",13),c("onClick",function(){h(s);let t=d().$implicit,e=d();return _(e.onReactivateOutcomeType(t))}),a()}r&2&&m("rounded",!0)("raised",!0)}function ve(r,n){if(r&1){let s=b();o(0,"tr")(1,"td"),u(2),a(),o(3,"td"),u(4),a(),o(5,"td"),v(6,"p-chip",8),a(),o(7,"td")(8,"div",9)(9,"p-button",10),c("onClick",function(){let e=h(s).$implicit,l=d();return _(l.onOpenForm(e))}),a(),y(10,_e,1,2,"p-button",11)(11,ye,1,2),a()()()}if(r&2){let s=n.$implicit;p(2),V(s.name),p(2),V(s.description),p(2),m("label",s.active?"Si":"No")("styleClass",s.active?"bg-blue-100 text-blue-600 text-sm shadow-3":"bg-red-100 text-red-600 text-sm shadow-3"),p(3),m("rounded",!0)("raised",!0),p(),C(10,s.active?10:11)}}var be=()=>({"min-width":"50rem"}),Ce=()=>["name","ruc"],Xe=(()=>{let n=class n{constructor(){this.messageService=g(J),this.confirmationService=g(G),this.cdr=g(N),this.outcomeTypeService=g(ne),this.outcomeTypes=[],this.modalData={title:"",visible:!1,data:null,response:null},this.toolbarHeight=0,this.containerOptions={dataLoading:!0,showNewButton:!0,showSearch:!0}}ngOnInit(){this.getOutcomeTypes()}ngAfterViewInit(){this.toolbarHeight=this.container.toolbar.getBlockableElement().clientHeight,this.cdr.detectChanges()}getOutcomeTypes(){this.containerOptions.dataLoading=!0,this.outcomeTypeService.findAll().subscribe({next:i=>{this.outcomeTypes=i.data,setTimeout(()=>{this.containerOptions.dataLoading=!1},300)},error:()=>{this.messageService.add({severity:"error",summary:"Error",detail:"Ha ocurrido un error al cargar los tipos de egreso."})}})}onOpenForm(i){this.modalData={title:i?"Editar tipo de egreso":"Nuevo tipo de egreso",visible:!0,data:i,response:null}}onSearch(i){this.table.filterGlobal(i,"contains")}onReactivateOutcomeType(i){this.confirmationService.confirm({message:`\xBFEst\xE1 seguro que desea habilitar el tipo de egreso
                <span class="font-bold"> ${i.name}</span>
                ?`,header:"Confirmar habilitaci\xF3n",icon:"pi pi-info-circle",acceptButtonStyleClass:"p-button-success ",rejectButtonStyleClass:"p-button-secondary",acceptIcon:"pi pi-tick mr-2",acceptLabel:"S\xED",rejectLabel:"No",accept:()=>{this.outcomeTypeService.activate(i.id).subscribe({next:t=>{this.messageService.add({severity:"success",summary:"Tipo de egreso habilitado",detail:t.message}),this.getOutcomeTypes()},error:t=>{t.error?t.status===500?this.messageService.add({severity:"error",summary:"Error",detail:t.error}):this.messageService.add({severity:"error",summary:"Error",detail:t.error.message}):this.messageService.add({severity:"error",summary:"Error",detail:"Error al habilitar el tipo de egreso."})}})}})}onDeleteOutcomeType(i){this.confirmationService.confirm({message:`\xBFEst\xE1 seguro que desea deshabilitar el tipo de egreso
                <span class="font-bold"> ${i.name}</span>
                ?`,header:"Confirmar deshabilitaci\xF3n",icon:"pi pi-info-circle",acceptButtonStyleClass:"p-button-danger",rejectButtonStyleClass:"p-button-secondary",acceptIcon:"pi pi-trash mr-2",acceptLabel:"S\xED",rejectLabel:"No",accept:()=>{this.outcomeTypeService.delete(i.id).subscribe({next:t=>{this.messageService.add({severity:"success",summary:"Tipo de egreso deshabilitado",detail:t.message}),this.getOutcomeTypes()},error:t=>{t.error?t.status===500?this.messageService.add({severity:"error",summary:"Error",detail:t.error}):this.messageService.add({severity:"error",summary:"Error",detail:t.error.message}):this.messageService.add({severity:"error",summary:"Error",detail:"Error al deshanbilidar el tipo de egreso."})}})}})}onHandleClose(){if(this.modalData.response){let i=this.modalData.response.id,t={name:this.modalData.response.name,description:this.modalData.response.description};i?this.outcomeTypeService.update(i,t).subscribe({next:e=>{this.getOutcomeTypes(),this.messageService.add({severity:"success",summary:"\xC9xito",detail:e.message}),this.reset()},error:e=>{e.error?e.status===500?this.messageService.add({severity:"error",summary:"Error",detail:e.error}):this.messageService.add({severity:"error",summary:"Error",detail:e.error.message}):this.messageService.add({severity:"error",summary:"Error",detail:"Error al actualizar el tipo de egreso."})}}):this.outcomeTypeService.create(t).subscribe({next:e=>{this.getOutcomeTypes(),this.messageService.add({severity:"success",summary:"\xC9xito",detail:e.message}),this.reset()},error:e=>{e.error?e.status===500?this.messageService.add({severity:"error",summary:"Error",detail:e.error}):this.messageService.add({severity:"error",summary:"Error",detail:e.error.message}):this.messageService.add({severity:"error",summary:"Error",detail:"Error al crear el tipo de egreso."})}})}else this.reset()}reset(){this.modalData={title:"",visible:!1,data:null,response:null}}};n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=T({type:n,selectors:[["app-types"]],viewQuery:function(t,e){if(t&1&&(D(fe,5),D(ge,5)),t&2){let l;O(l=F())&&(e.container=l.first),O(l=F())&&(e.table=l.first)}},standalone:!0,features:[S],decls:7,vars:13,consts:[[1,"block","mt-2",3,"options","onSearch","onOpenForm"],["container",""],["styleClass","p-datatable-sm p-datatable-striped",3,"value","tableStyle","paginator","rows","showJumpToPageDropdown","scrollable","currentPageReportTemplate","scrollHeight","globalFilterFields"],["table",""],["pTemplate","header"],["pTemplate","body"],[3,"modalData","handleClose"],[1,"w-15rem"],[3,"label","styleClass"],[1,"flex","gap-2"],["icon","pi pi-pencil","severity","warning","label","Editar","size","small",3,"rounded","raised","onClick"],["icon","pi pi-trash","severity","danger","label","Inhabilitar","size","small",3,"rounded","raised"],["icon","pi pi-trash","severity","danger","label","Inhabilitar","size","small",3,"rounded","raised","onClick"],["icon","pi pi-undo","severity","help","label","Habilitar","size","small",3,"rounded","raised","onClick"]],template:function(t,e){t&1&&(o(0,"app-container",0,1),c("onSearch",function(f){return e.onSearch(f)})("onOpenForm",function(){return e.onOpenForm()}),o(2,"p-table",2,3),y(4,he,9,0,"ng-template",4)(5,ve,12,7,"ng-template",5),a()(),o(6,"app-outcome-type-form",6),c("handleClose",function(){return e.onHandleClose()}),a()),t&2&&(m("options",e.containerOptions),p(2),m("value",e.outcomeTypes)("tableStyle",k(11,be))("paginator",!0)("rows",20)("showJumpToPageDropdown",!0)("scrollable",!0)("currentPageReportTemplate","{currentPage} de {totalPages} p\xE1ginas ({totalRecords} registros)")("scrollHeight","calc(100vh - "+e.toolbarHeight+"px - 18.0rem)")("globalFilterFields",k(12,Ce)),p(4),m("modalData",e.modalData))},dependencies:[ie,Z,Y,x,w,E,oe,re,se]});let r=n;return r})();export{Xe as TypesComponent};
