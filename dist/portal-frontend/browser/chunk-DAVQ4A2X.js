import{a as J}from"./chunk-KDT3BQPU.js";import{a as q,b as G}from"./chunk-DEGAUCA6.js";import{n as U}from"./chunk-U446ZUSE.js";import"./chunk-7XV6CRBL.js";import"./chunk-LFBU7IBC.js";import"./chunk-6OSMVD66.js";import"./chunk-IAKHD2KQ.js";import"./chunk-KTZAFNHT.js";import"./chunk-L2YMTAJ4.js";import"./chunk-SQDM7FYD.js";import"./chunk-MUUDK5FO.js";import"./chunk-GS33KFGJ.js";import{m as k,n as Q,q as $,x as z}from"./chunk-OHCSBWXS.js";import"./chunk-APKN3PFA.js";import"./chunk-X6GEXHSG.js";import"./chunk-MX4UQD2B.js";import"./chunk-X5B2VV3T.js";import"./chunk-ZTWDMVRM.js";import"./chunk-P7FDEGEE.js";import"./chunk-XSSXK7EZ.js";import{a as R}from"./chunk-PXO2TRVQ.js";import"./chunk-PWTX4GCB.js";import"./chunk-HXGQMCX4.js";import{a as H}from"./chunk-RQIDKQUN.js";import"./chunk-WTM76CTQ.js";import{d as B,e as L}from"./chunk-AXYD25ST.js";import{i as O,n as V}from"./chunk-VBSZGXZN.js";import{$ as P,Bc as j,Db as T,Eb as I,Fb as N,Hb as l,Ib as u,Nc as A,Ob as F,Pb as M,S as b,Ta as p,Wa as S,Y as c,Yb as v,_b as y,ab as E,db as C,ea as f,fa as _,fb as m,kb as w,ob as n,pb as o,qb as D,ub as x,wb as h,xb as g}from"./chunk-HOTPW52P.js";var K=(()=>{let a=class a{constructor(){this.END_POINT=H.API_URL+"/protected/passages",this.http=c(A)}findAll(e=0,t=""){return this.http.get(this.END_POINT+`?page=${e}&search=${t}`)}create(e){return this.http.post(this.END_POINT,e)}update(e,t){return this.http.put(this.END_POINT+`/${e}`,t)}};a.\u0275fac=function(t){return new(t||a)},a.\u0275prov=b({token:a,factory:a.\u0275fac,providedIn:"root"});let i=a;return i})();var Y=["container"];function Z(i,a){i&1&&(n(0,"tr")(1,"th"),l(2,"Pasaje"),o(),n(3,"th"),l(4,"Activo"),o(),n(5,"th",7),l(6,"Fecha de creaci\xF3n"),o(),n(7,"th",7),l(8,"Fecha de actualizaci\xF3n"),o(),n(9,"th"),l(10,"Acciones"),o()())}function ee(i,a){if(i&1){let s=x();n(0,"tr")(1,"td"),l(2),o(),n(3,"td"),D(4,"p-chip",8),o(),n(5,"td"),l(6),v(7,"date"),o(),n(8,"td"),l(9),v(10,"date"),o(),n(11,"td")(12,"div",9)(13,"p-button",10),h("onClick",function(){let r=f(s).$implicit,d=g();return _(d.openForm(r))}),o()()()()}if(i&2){let s=a.$implicit;p(2),u(s.name),p(2),m("label",s.active?"Si":"No")("styleClass",s.active?"bg-blue-100 text-blue-600 text-sm shadow-3":"bg-red-100 text-red-600 text-sm shadow-3"),p(2),u(y(7,7,s.createdAt,"dd/MM/yyyy")),p(3),u(y(10,10,s.updatedAt,"dd/MM/yyyy")),p(4),m("rounded",!0)("raised",!0)}}function te(i,a){if(i&1){let s=x();n(0,"div",12)(1,"p-paginator",13),h("onPageChange",function(t){f(s);let r=g(2);return _(r.onPageChange(t))}),o()()}if(i&2){let s=g(2);p(),m("rows",s.rows)("first",s.first)("totalRecords",s.totalItems)}}function ie(i,a){i&1&&(n(0,"div",12)(1,"p",14),l(2,"No hay datos para mostrar"),o()())}function ae(i,a){if(i&1&&C(0,te,2,3,"div",11)(1,ie,3,0),i&2){let s=g();w(0,s.passages.length>0?0:1)}}var ne=()=>({"min-width":"50rem"}),Fe=(()=>{let a=class a extends R{constructor(){super(),this.first=0,this.dataLoading=!0,this.rows=10,this.totalItems=0,this.summary="",this.passages=[],this.modalData={visible:!1,title:"",data:null,response:null},this.toolbarHeight=0,this.containerOptions={showNewButton:!1,showSearch:!0,dataLoading:!0},this.passageService=c(K),this.messageService=c(O),this.cdr=c(S)}ngOnInit(){super.ngOnInit(),this.getPassages()}handleFindAllNext(e){this.containerOptions.dataLoading=!0;let t=e.data;this.passages=t.content,this.totalItems=t.totalItems,setTimeout(()=>{this.containerOptions.dataLoading=!1},300)}handleError(e){this.messageService.add({severity:"error",summary:"Error",detail:e.error||e.status===404?"No se encontrado el pasaje":"Ha ocurrido un error"}),this.modalData.response=null}getPassages(e=0,t=""){this.passageService.findAll(e,t).subscribe({next:this.handleFindAllNext.bind(this),error:this.handleError.bind(this)})}onSearch(e){this.getPassages(0,e),this.first=0}openForm(e){this.modalData={visible:!0,title:e?"Editar Pasaje":"Nuevo Pasaje",data:e,response:null}}onPageChange(e){let t=this.container.searchInput.nativeElement.value;this.getPassages(e.page,t),this.first=e.first}getHandleClose(){if(this.modalData.response){let e=this.modalData.response.id;if(e){let t=this.modalData.response;this.passageService.update(e,t).subscribe({next:r=>{this.messageService.add({severity:"success",summary:"Exito",detail:r.message}),this.reset(),this.getPassages()},error:this.handleError.bind(this)})}}else this.reset()}reset(){this.modalData={visible:!1,title:"",data:null,response:null}}ngAfterViewInit(){this.toolbarHeight=this.container.toolbar.getBlockableElement().clientHeight,this.cdr.detectChanges()}};a.\u0275fac=function(t){return new(t||a)},a.\u0275cmp=P({type:a,selectors:[["app-passages"]],viewQuery:function(t,r){if(t&1&&T(Y,5),t&2){let d;I(d=N())&&(r.container=d.first)}},standalone:!0,features:[E,F],decls:7,vars:7,consts:[[3,"options","onSearch"],["container",""],["styleClass","p-datatable-sm p-datatable-striped",3,"value","tableStyle","scrollable","scrollHeight"],["pTemplate","header"],["pTemplate","body"],["pTemplate","summary"],[3,"modalData","handleClose"],[1,"max-w-8rem"],[3,"label","styleClass"],[1,"flex","gap-1"],["icon","pi pi-pencil","severity","warning","label","Editar","size","small",3,"rounded","raised","onClick"],["class","flex justify-content-center "],[1,"flex","justify-content-center"],[3,"rows","first","totalRecords","onPageChange"],[1,"text-lg","py-2","px-4"]],template:function(t,r){t&1&&(n(0,"app-container",0,1),h("onSearch",function(W){return r.onSearch(W)}),n(2,"p-table",2),C(3,Z,11,0,"ng-template",3)(4,ee,14,13,"ng-template",4)(5,ae,2,1,"ng-template",5),o()(),n(6,"app-passage-form",6),h("handleClose",function(){return r.getHandleClose()}),o()),t&2&&(m("options",r.containerOptions),p(2),m("value",r.passages)("tableStyle",M(6,ne))("scrollable",!0)("scrollHeight","calc(100vh - "+r.toolbarHeight+"px - 13.5rem)"),p(4),m("modalData",r.modalData))},dependencies:[J,U,z,$,V,G,q,L,B,Q,k,j]});let i=a;return i})();export{Fe as PassagesComponent};
