import{a as qt,b as Qt,c as $t,d as Xt}from"./chunk-DGE2IGT7.js";import{a as zt,b as Ut}from"./chunk-ELGNCYQ4.js";import{a as j,b as A}from"./chunk-6T5XIYJ5.js";import{a as Ue}from"./chunk-MRWSOSDG.js";import{a as wt,b as St}from"./chunk-THPYG6QI.js";import{a as ke,b as Me}from"./chunk-B2W5NOZS.js";import{c as $,i as Et,j as Vt,k as Le,l as Dt}from"./chunk-WY5L5QV5.js";import"./chunk-WYL7NH4F.js";import{a as Bt,b as jt}from"./chunk-RC3HNZO7.js";import{a as At}from"./chunk-QFJMZTM2.js";import{a as Rt,b as Lt}from"./chunk-DEGAUCA6.js";import{a as kt,d as Pt,e as Nt,j as Gt}from"./chunk-Y6YU6P5I.js";import{c as Ot,d as Ht}from"./chunk-YGKFOOJ6.js";import{a as Mt,b as Ft}from"./chunk-7XV6CRBL.js";import{a as Be,b as je}from"./chunk-LFBU7IBC.js";import{a as Ae,b as ze}from"./chunk-6OSMVD66.js";import"./chunk-IAKHD2KQ.js";import"./chunk-KTZAFNHT.js";import"./chunk-L2YMTAJ4.js";import{e as Q,f as B}from"./chunk-SQDM7FYD.js";import"./chunk-MUUDK5FO.js";import"./chunk-GS33KFGJ.js";import{h as Fe,i as Pe,k as Ne,l as Oe,m as He,n as Ge,o as Tt,p as It,q as le,r as Re,x as se}from"./chunk-OHCSBWXS.js";import"./chunk-APKN3PFA.js";import"./chunk-X6GEXHSG.js";import{a as Ee,b as Ve}from"./chunk-MX4UQD2B.js";import"./chunk-X5B2VV3T.js";import"./chunk-ZTWDMVRM.js";import"./chunk-P7FDEGEE.js";import{c as vt,d as Xe,f as Ze,h as Ye}from"./chunk-XSSXK7EZ.js";import{a as De}from"./chunk-PXO2TRVQ.js";import"./chunk-PWTX4GCB.js";import{a as ft,b as Y,c as M,e as W,f as J,i as K,j as ee,k as te,l as Ct,m as Se,o as ie,p as ne,q as oe}from"./chunk-HXGQMCX4.js";import{a as we}from"./chunk-TDXTCVPJ.js";import"./chunk-WTM76CTQ.js";import{c as ae,d as R,e as L}from"./chunk-AXYD25ST.js";import{c as Te,e as Ie,i as re,j as yt,k as bt,n as G,q as me,r as xt}from"./chunk-VBSZGXZN.js";import{$ as F,Bc as be,Db as T,Dc as _t,Eb as I,Fb as E,Fc as ht,Gb as P,Hb as c,Ib as S,Jb as X,Ka as pe,Kc as $e,Lb as dt,Lc as gt,Ma as at,Nc as xe,Oa as lt,Ob as H,Pb as k,Qb as V,R as it,Rb as fe,S as _e,T as nt,Ta as s,Ua as U,Ub as pt,Wa as he,Y as w,Yb as Ce,Za as q,_b as ve,a as et,aa as ot,ab as ge,b as tt,da as z,db as f,ea as u,eb as O,fa as _,fb as p,gb as st,ib as D,jb as ce,kb as b,ob as r,oc as ct,pb as a,qb as h,ta as rt,ub as x,wb as g,wc as ye,xb as d,yc as mt,zc as ut}from"./chunk-HOTPW52P.js";var de=(()=>{let l=class l{constructor(){this.END_POINT=we.API_URL+"/protected/incident-type",this.http=w(xe)}getIncidentTypes(){return this.http.get(this.END_POINT)}getActiveIncidentTypes(){return this.http.get(this.END_POINT+"/active")}createIncidentType(t){return this.http.post(this.END_POINT,t)}updateIncidentType(t,o){return this.http.put(this.END_POINT+"/"+o,t)}deleteIncidentType(t){return this.http.delete(this.END_POINT+"/"+t)}reactivateIncidentType(t){return this.http.put(this.END_POINT+`/${t}/reactivate`,{})}};l.\u0275fac=function(o){return new(o||l)},l.\u0275prov=_e({token:l,factory:l.\u0275fac,providedIn:"root"});let i=l;return i})();var ai=["container"],li=["input"],si=["colorSelector"],di=["colorHandle"],pi=["hue"],ci=["hueHandle"],mi=i=>({"p-disabled":i});function ui(i,l){if(i&1){let e=x();r(0,"input",4,5),g("click",function(){u(e);let o=d();return _(o.onInputClick())})("keydown",function(o){u(e);let n=d();return _(n.onInputKeydown(o))})("focus",function(){u(e);let o=d();return _(o.onInputFocus())}),a()}if(i&2){let e=d();st("background-color",e.inputBgColor),p("ngClass",V(7,mi,e.disabled))("disabled",e.disabled),O("tabindex",e.tabindex)("id",e.inputId)("data-pc-section","input")}}var _i=(i,l)=>({"p-colorpicker-panel":!0,"p-colorpicker-overlay-panel":i,"p-disabled":l}),hi=(i,l)=>({showTransitionParams:i,hideTransitionParams:l}),gi=i=>({value:"visible",params:i});function fi(i,l){if(i&1){let e=x();r(0,"div",6),g("click",function(o){u(e);let n=d();return _(n.onOverlayClick(o))})("@overlayAnimation.start",function(o){u(e);let n=d();return _(n.onOverlayAnimationStart(o))})("@overlayAnimation.done",function(o){u(e);let n=d();return _(n.onOverlayAnimationEnd(o))}),r(1,"div",7)(2,"div",8,9),g("touchstart",function(o){u(e);let n=d();return _(n.onColorDragStart(o))})("touchmove",function(o){u(e);let n=d();return _(n.onDrag(o))})("touchend",function(){u(e);let o=d();return _(o.onDragEnd())})("mousedown",function(o){u(e);let n=d();return _(n.onColorMousedown(o))}),r(4,"div",10),h(5,"div",11,12),a()(),r(7,"div",13,14),g("mousedown",function(o){u(e);let n=d();return _(n.onHueMousedown(o))})("touchstart",function(o){u(e);let n=d();return _(n.onHueDragStart(o))})("touchmove",function(o){u(e);let n=d();return _(n.onDrag(o))})("touchend",function(){u(e);let o=d();return _(o.onDragEnd())}),h(9,"div",15,16),a()()()}if(i&2){let e=d();p("ngClass",fe(10,_i,!e.inline,e.disabled))("@overlayAnimation",V(16,gi,fe(13,hi,e.showTransitionOptions,e.hideTransitionOptions)))("@.disabled",e.inline===!0),O("data-pc-section","panel"),s(),O("data-pc-section","content"),s(),O("data-pc-section","selector"),s(2),O("data-pc-section","color"),s(),O("data-pc-section","colorHandle"),s(2),O("data-pc-section","hue"),s(2),O("data-pc-section","hueHandle")}}var Ci=(i,l)=>({"p-colorpicker p-component":!0,"p-colorpicker-overlay":i,"p-colorpicker-dragging":l}),vi={provide:ft,useExisting:it(()=>We),multi:!0},We=(()=>{class i{document;platformId;el;renderer;cd;config;overlayService;style;styleClass;inline;format="hex";appendTo;disabled;tabindex;inputId;autoZIndex=!0;baseZIndex=0;showTransitionOptions=".12s cubic-bezier(0, 0, 0.2, 1)";hideTransitionOptions=".1s linear";onChange=new q;onShow=new q;onHide=new q;containerViewChild;inputViewChild;value={h:0,s:100,b:100};inputBgColor;shown;overlayVisible;defaultColor="ff0000";onModelChange=()=>{};onModelTouched=()=>{};documentClickListener;documentResizeListener;documentMousemoveListener;documentMouseupListener;documentHueMoveListener;scrollHandler;selfClick;colorDragging;hueDragging;overlay;colorSelectorViewChild;colorHandleViewChild;hueViewChild;hueHandleViewChild;window;constructor(e,t,o,n,m,C,v){this.document=e,this.platformId=t,this.el=o,this.renderer=n,this.cd=m,this.config=C,this.overlayService=v,this.window=this.document.defaultView}set colorSelector(e){this.colorSelectorViewChild=e}set colorHandle(e){this.colorHandleViewChild=e}set hue(e){this.hueViewChild=e}set hueHandle(e){this.hueHandleViewChild=e}onHueMousedown(e){this.disabled||(this.bindDocumentMousemoveListener(),this.bindDocumentMouseupListener(),this.hueDragging=!0,this.pickHue(e))}onHueDragStart(e){this.disabled||(this.hueDragging=!0,this.pickHue(e,e.changedTouches[0]))}onColorDragStart(e){this.disabled||(this.colorDragging=!0,this.pickColor(e,e.changedTouches[0]))}pickHue(e,t){let o=t?t.pageY:e.pageY,n=this.hueViewChild?.nativeElement.getBoundingClientRect().top+(this.document.defaultView.pageYOffset||this.document.documentElement.scrollTop||this.document.body.scrollTop||0);this.value=this.validateHSB({h:Math.floor(360*(150-Math.max(0,Math.min(150,o-n)))/150),s:this.value.s,b:this.value.b}),this.updateColorSelector(),this.updateUI(),this.updateModel(),this.onChange.emit({originalEvent:e,value:this.getValueToUpdate()})}onColorMousedown(e){this.disabled||(this.bindDocumentMousemoveListener(),this.bindDocumentMouseupListener(),this.colorDragging=!0,this.pickColor(e))}onDrag(e){this.colorDragging&&(this.pickColor(e,e.changedTouches[0]),e.preventDefault()),this.hueDragging&&(this.pickHue(e,e.changedTouches[0]),e.preventDefault())}onDragEnd(){this.colorDragging=!1,this.hueDragging=!1,this.unbindDocumentMousemoveListener(),this.unbindDocumentMouseupListener()}pickColor(e,t){let o=t?t.pageX:e.pageX,n=t?t.pageY:e.pageY,m=this.colorSelectorViewChild?.nativeElement.getBoundingClientRect(),C=m.top+(this.document.defaultView.pageYOffset||this.document.documentElement.scrollTop||this.document.body.scrollTop||0),v=m.left+this.document.body.scrollLeft,y=Math.floor(100*Math.max(0,Math.min(150,o-v))/150),N=Math.floor(100*(150-Math.max(0,Math.min(150,n-C)))/150);this.value=this.validateHSB({h:this.value.h,s:y,b:N}),this.updateUI(),this.updateModel(),this.onChange.emit({originalEvent:e,value:this.getValueToUpdate()})}getValueToUpdate(){let e;switch(this.format){case"hex":e="#"+this.HSBtoHEX(this.value);break;case"rgb":e=this.HSBtoRGB(this.value);break;case"hsb":e=this.value;break}return e}updateModel(){this.onModelChange(this.getValueToUpdate())}writeValue(e){if(e)switch(this.format){case"hex":this.value=this.HEXtoHSB(e);break;case"rgb":this.value=this.RGBtoHSB(e);break;case"hsb":this.value=e;break}else this.value=this.HEXtoHSB(this.defaultColor);this.updateColorSelector(),this.updateUI(),this.cd.markForCheck()}updateColorSelector(){if(this.colorSelectorViewChild){let e={};e.s=100,e.b=100,e.h=this.value.h,this.colorSelectorViewChild.nativeElement.style.backgroundColor="#"+this.HSBtoHEX(e)}}updateUI(){this.colorHandleViewChild&&this.hueHandleViewChild?.nativeElement&&(this.colorHandleViewChild.nativeElement.style.left=Math.floor(150*this.value.s/100)+"px",this.colorHandleViewChild.nativeElement.style.top=Math.floor(150*(100-this.value.b)/100)+"px",this.hueHandleViewChild.nativeElement.style.top=Math.floor(150-150*this.value.h/360)+"px"),this.inputBgColor="#"+this.HSBtoHEX(this.value)}onInputFocus(){this.onModelTouched()}show(){this.overlayVisible=!0,this.cd.markForCheck()}onOverlayAnimationStart(e){switch(e.toState){case"visible":this.inline||(this.overlay=e.element,this.appendOverlay(),this.autoZIndex&&Te.set("overlay",this.overlay,this.config.zIndex.overlay),this.alignOverlay(),this.bindDocumentClickListener(),this.bindDocumentResizeListener(),this.bindScrollListener(),this.updateColorSelector(),this.updateUI());break;case"void":this.onOverlayHide();break}}onOverlayAnimationEnd(e){switch(e.toState){case"visible":this.inline||this.onShow.emit({});break;case"void":this.autoZIndex&&Te.clear(e.element),this.onHide.emit({});break}}appendOverlay(){this.appendTo&&(this.appendTo==="body"?this.renderer.appendChild(this.document.body,this.overlay):me.appendChild(this.overlay,this.appendTo))}restoreOverlayAppend(){this.overlay&&this.appendTo&&this.renderer.appendChild(this.el.nativeElement,this.overlay)}alignOverlay(){this.appendTo?me.absolutePosition(this.overlay,this.inputViewChild?.nativeElement):me.relativePosition(this.overlay,this.inputViewChild?.nativeElement)}hide(){this.overlayVisible=!1,this.cd.markForCheck()}onInputClick(){this.selfClick=!0,this.togglePanel()}togglePanel(){this.overlayVisible?this.hide():this.show()}onInputKeydown(e){switch(e.code){case"Space":this.togglePanel(),e.preventDefault();break;case"Escape":case"Tab":this.hide();break;default:break}}onOverlayClick(e){this.overlayService.add({originalEvent:e,target:this.el.nativeElement}),this.selfClick=!0}registerOnChange(e){this.onModelChange=e}registerOnTouched(e){this.onModelTouched=e}setDisabledState(e){this.disabled=e,this.cd.markForCheck()}bindDocumentClickListener(){if(!this.documentClickListener){let e=this.el?this.el.nativeElement.ownerDocument:"document";this.documentClickListener=this.renderer.listen(e,"click",()=>{this.selfClick||(this.overlayVisible=!1,this.unbindDocumentClickListener()),this.selfClick=!1,this.cd.markForCheck()})}}unbindDocumentClickListener(){this.documentClickListener&&(this.documentClickListener(),this.documentClickListener=null)}bindDocumentMousemoveListener(){if(!this.documentMousemoveListener){let e=this.el?this.el.nativeElement.ownerDocument:"document";this.documentMousemoveListener=this.renderer.listen(e,"mousemove",t=>{this.colorDragging&&this.pickColor(t),this.hueDragging&&this.pickHue(t)})}}unbindDocumentMousemoveListener(){this.documentMousemoveListener&&(this.documentMousemoveListener(),this.documentMousemoveListener=null)}bindDocumentMouseupListener(){if(!this.documentMouseupListener){let e=this.el?this.el.nativeElement.ownerDocument:"document";this.documentMouseupListener=this.renderer.listen(e,"mouseup",()=>{this.colorDragging=!1,this.hueDragging=!1,this.unbindDocumentMousemoveListener(),this.unbindDocumentMouseupListener()})}}unbindDocumentMouseupListener(){this.documentMouseupListener&&(this.documentMouseupListener(),this.documentMouseupListener=null)}bindDocumentResizeListener(){ht(this.platformId)&&(this.documentResizeListener=this.renderer.listen(this.window,"resize",this.onWindowResize.bind(this)))}unbindDocumentResizeListener(){this.documentResizeListener&&(this.documentResizeListener(),this.documentResizeListener=null)}onWindowResize(){this.overlayVisible&&!me.isTouchDevice()&&this.hide()}bindScrollListener(){this.scrollHandler||(this.scrollHandler=new xt(this.containerViewChild?.nativeElement,()=>{this.overlayVisible&&this.hide()})),this.scrollHandler.bindScrollListener()}unbindScrollListener(){this.scrollHandler&&this.scrollHandler.unbindScrollListener()}validateHSB(e){return{h:Math.min(360,Math.max(0,e.h)),s:Math.min(100,Math.max(0,e.s)),b:Math.min(100,Math.max(0,e.b))}}validateRGB(e){return{r:Math.min(255,Math.max(0,e.r)),g:Math.min(255,Math.max(0,e.g)),b:Math.min(255,Math.max(0,e.b))}}validateHEX(e){var t=6-e.length;if(t>0){for(var o=[],n=0;n<t;n++)o.push("0");o.push(e),e=o.join("")}return e}HEXtoRGB(e){let t=parseInt(e.indexOf("#")>-1?e.substring(1):e,16);return{r:t>>16,g:(t&65280)>>8,b:t&255}}HEXtoHSB(e){return this.RGBtoHSB(this.HEXtoRGB(e))}RGBtoHSB(e){var t={h:0,s:0,b:0},o=Math.min(e.r,e.g,e.b),n=Math.max(e.r,e.g,e.b),m=n-o;return t.b=n,t.s=n!=0?255*m/n:0,t.s!=0?e.r==n?t.h=(e.g-e.b)/m:e.g==n?t.h=2+(e.b-e.r)/m:t.h=4+(e.r-e.g)/m:t.h=-1,t.h*=60,t.h<0&&(t.h+=360),t.s*=100/255,t.b*=100/255,t}HSBtoRGB(e){var t={r:0,g:0,b:0};let o=e.h,n=e.s*255/100,m=e.b*255/100;if(n==0)t={r:m,g:m,b:m};else{let C=m,v=(255-n)*m/255,y=(C-v)*(o%60)/60;o==360&&(o=0),o<60?(t.r=C,t.b=v,t.g=v+y):o<120?(t.g=C,t.b=v,t.r=C-y):o<180?(t.g=C,t.r=v,t.b=v+y):o<240?(t.b=C,t.r=v,t.g=C-y):o<300?(t.b=C,t.g=v,t.r=v+y):o<360?(t.r=C,t.g=v,t.b=C-y):(t.r=0,t.g=0,t.b=0)}return{r:Math.round(t.r),g:Math.round(t.g),b:Math.round(t.b)}}RGBtoHEX(e){var t=[e.r.toString(16),e.g.toString(16),e.b.toString(16)];for(var o in t)t[o].length==1&&(t[o]="0"+t[o]);return t.join("")}HSBtoHEX(e){return this.RGBtoHEX(this.HSBtoRGB(e))}onOverlayHide(){this.unbindScrollListener(),this.unbindDocumentResizeListener(),this.unbindDocumentClickListener(),this.overlay=null}ngOnDestroy(){this.scrollHandler&&(this.scrollHandler.destroy(),this.scrollHandler=null),this.overlay&&this.autoZIndex&&Te.clear(this.overlay),this.restoreOverlayAppend(),this.onOverlayHide()}static \u0275fac=function(t){return new(t||i)(U(ct),U(rt),U(at),U(lt),U(he),U(bt),U(yt))};static \u0275cmp=F({type:i,selectors:[["p-colorPicker"]],viewQuery:function(t,o){if(t&1&&(T(ai,5),T(li,5),T(si,5),T(di,5),T(pi,5),T(ci,5)),t&2){let n;I(n=E())&&(o.containerViewChild=n.first),I(n=E())&&(o.inputViewChild=n.first),I(n=E())&&(o.colorSelector=n.first),I(n=E())&&(o.colorHandle=n.first),I(n=E())&&(o.hue=n.first),I(n=E())&&(o.hueHandle=n.first)}},hostAttrs:[1,"p-element"],inputs:{style:"style",styleClass:"styleClass",inline:"inline",format:"format",appendTo:"appendTo",disabled:"disabled",tabindex:"tabindex",inputId:"inputId",autoZIndex:"autoZIndex",baseZIndex:"baseZIndex",showTransitionOptions:"showTransitionOptions",hideTransitionOptions:"hideTransitionOptions"},outputs:{onChange:"onChange",onShow:"onShow",onHide:"onHide"},features:[dt([vi])],decls:4,vars:11,consts:[[3,"ngStyle","ngClass"],["container",""],["type","text","class","p-colorpicker-preview p-inputtext","readonly","readonly",3,"ngClass","disabled","backgroundColor","click","keydown","focus",4,"ngIf"],[3,"ngClass","click",4,"ngIf"],["type","text","readonly","readonly",1,"p-colorpicker-preview","p-inputtext",3,"ngClass","disabled","click","keydown","focus"],["input",""],[3,"ngClass","click"],[1,"p-colorpicker-content"],[1,"p-colorpicker-color-selector",3,"touchstart","touchmove","touchend","mousedown"],["colorSelector",""],[1,"p-colorpicker-color"],[1,"p-colorpicker-color-handle"],["colorHandle",""],[1,"p-colorpicker-hue",3,"mousedown","touchstart","touchmove","touchend"],["hue",""],[1,"p-colorpicker-hue-handle"],["hueHandle",""]],template:function(t,o){t&1&&(r(0,"div",0,1),f(2,ui,2,9,"input",2)(3,fi,11,18,"div",3),a()),t&2&&(ce(o.styleClass),p("ngStyle",o.style)("ngClass",fe(8,Ci,!o.inline,o.colorDragging||o.hueDragging)),O("data-pc-name","colorpicker")("data-pc-section","root"),s(2),p("ngIf",!o.inline),s(),p("ngIf",o.inline||o.overlayVisible))},dependencies:[ye,mt,ut],styles:[`@layer primeng{.p-colorpicker{display:inline-block}.p-colorpicker-dragging{cursor:pointer}.p-colorpicker-overlay{position:relative}.p-colorpicker-panel{position:relative;width:193px;height:166px}.p-colorpicker-overlay-panel{position:absolute;top:0;left:0}.p-colorpicker-preview{cursor:pointer}.p-colorpicker-panel .p-colorpicker-content{position:relative}.p-colorpicker-panel .p-colorpicker-color-selector{width:150px;height:150px;top:8px;left:8px;position:absolute}.p-colorpicker-panel .p-colorpicker-color{width:150px;height:150px}.p-colorpicker-panel .p-colorpicker-color-handle{position:absolute;top:0;left:150px;border-radius:100%;width:10px;height:10px;border-width:1px;border-style:solid;margin:-5px 0 0 -5px;cursor:pointer;opacity:.85}.p-colorpicker-panel .p-colorpicker-hue{width:17px;height:150px;top:8px;left:167px;position:absolute;opacity:.85}.p-colorpicker-panel .p-colorpicker-hue-handle{position:absolute;top:150px;left:0;width:21px;margin-left:-2px;margin-top:-5px;height:10px;border-width:2px;border-style:solid;opacity:.85;cursor:pointer}}
`],encapsulation:2,data:{animation:[vt("overlayAnimation",[Ye(":enter",[Ze({opacity:0,transform:"scaleY(0.8)"}),Xe("{{showTransitionParams}}")]),Ye(":leave",[Xe("{{hideTransitionParams}}",Ze({opacity:0}))])])]},changeDetection:0})}return i})(),Zt=(()=>{class i{static \u0275fac=function(t){return new(t||i)};static \u0275mod=ot({type:i});static \u0275inj=nt({imports:[_t]})}return i})();function xi(i,l){if(i&1&&h(0,"app-error-input",8),i&2){let e=d();p("message",e.getErrorMessage("name",e.form))}}function wi(i,l){if(i&1&&h(0,"app-error-input",8),i&2){let e=d();p("message",e.getErrorMessage("severity",e.form))}}var Si=i=>({backgroundColor:i,textWrap:"ellipsis"});function Ti(i,l){if(i&1&&h(0,"p-tag",24,25),i&2){let e=d(),t;D(V(3,Si,e.form.get("severity").value)),p("value",((t=e.form.get("name"))==null?null:t.value)||"Valor")}}function Ii(i,l){if(i&1&&(r(0,"div",16)(1,"label",11),c(2,"Activo"),a(),h(3,"p-selectButton",26),a()),i&2){let e=d();s(3),p("options",e.stateOptions)("allowEmpty",!1)}}function Ei(i,l){if(i&1){let e=x();r(0,"p-button",27),g("onClick",function(){u(e);let o=d();return _(o.handleAccept())}),a(),r(1,"p-button",28),g("onClick",function(){u(e);let o=d();return _(o.handleClose.emit())}),a()}i&2&&(p("raised",!0)("rounded",!0),s(),p("raised",!0)("rounded",!0))}var Jt=(()=>{let l=class l{constructor(){this.modalData={visible:!1,title:"",data:null,response:null},this.handleClose=new q,this.showPreview=!1,this.fb=w(Se),this.getErrorMessage=Ve,this.form=this.fb.group({id:[""],name:["",M.required],description:["",M.required],severity:["#000000",M.required],active:[""]}),this.stateOptions=[{label:"Si",value:!0},{label:"No",value:!1}]}handleAccept(){this.form.valid?(this.modalData.response=this.form.value,this.handleClose.emit()):Object.values(this.form.controls).forEach(t=>{t.invalid&&(t.markAsDirty(),t.updateValueAndValidity({onlySelf:!0}))})}ngOnChanges(t){t.modalData&&(this.form.reset(),this.modalData.data&&(this.form.patchValue(this.modalData.data),this.form.get("active")?.setValidators(M.required),this.form.get("active")?.updateValueAndValidity({onlySelf:!0})))}onShowPreview(){this.showPreview||(this.showPreview=!0,setTimeout(()=>{this.showPreview=!1},2e3))}};l.\u0275fac=function(o){return new(o||l)},l.\u0275cmp=F({type:l,selectors:[["app-incident-type-form"]],inputs:{modalData:"modalData"},outputs:{handleClose:"handleClose"},standalone:!0,features:[z,H],decls:31,vars:13,consts:[["styleClass","w-10 md:w-8 lg:w-6",3,"header","visible","modal","draggable","resizable","visibleChange","onHide"],[1,"pt-4","grid","nested-grid",3,"formGroup"],[1,"col-12","lg:col-6"],[1,"grid","row-gap-3"],[1,"col-12"],[1,"p-float-label"],["pInputText","","id","name","formControlName","name","autocomplete","off","type","text",1,"w-full"],["for","name"],[3,"message"],[1,"col-12","grid"],[1,"col-6","relative"],["for","severity",1,"text-xs","text-gray-500","block","ml-2","absolute","left-0",2,"top","-1rem"],["formControlName","severity","appendTo","body"],[1,"ml-2"],[1,"col-6","flex","justify-content-end"],["label","Ver vista previa","size","small","severity","secondary",3,"raised","rounded","onClick"],[1,"col-12","relative"],["styleClass","uppercase",3,"value","style"],["class","col-12 relative"],[1,"col-6"],[1,"p-float-label","h-full"],["id","float-input","pInputTextarea","","formControlName","description","id","description",1,"w-full","h-full"],["for","description"],["pTemplate","footer"],["styleClass","uppercase",3,"value"],["tag",""],["optionLabel","label","optionValue","value","styleClass","ml-2 p-button-sm","formControlName","active",3,"options","allowEmpty"],["label","Aceptar","severity","success",3,"raised","rounded","onClick"],["label","Cancelar","severity","danger",3,"raised","rounded","onClick"]],template:function(o,n){if(o&1&&(r(0,"p-dialog",0),g("visibleChange",function(C){return n.modalData.visible=C})("onHide",function(){return n.handleClose.emit()}),r(1,"form",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"span",5),h(6,"input",6),r(7,"label",7),c(8,"Nombre"),a()(),f(9,xi,1,1,"app-error-input",8),a(),r(10,"div",9)(11,"div",10)(12,"label",11),c(13,"Color"),a(),h(14,"p-colorPicker",12),r(15,"span",13),c(16),a(),f(17,wi,1,1,"app-error-input",8),a(),r(18,"div",14)(19,"p-button",15),g("onClick",function(){return n.onShowPreview()}),a()()(),r(20,"div",16)(21,"label",11),c(22,"Vista previa"),a(),f(23,Ti,2,5,"p-tag",17),a(),f(24,Ii,4,2,"div",18),a()(),r(25,"div",19)(26,"span",20),h(27,"textarea",21),r(28,"label",22),c(29,"Descripcion"),a()()()(),f(30,Ei,2,4,"ng-template",23),a()),o&2){let m,C,v,y;p("header",n.modalData.title)("visible",n.modalData.visible)("modal",!0)("draggable",!1)("resizable",!1),s(),p("formGroup",n.form),s(8),b(9,(m=n.form.get("name"))!=null&&m.invalid&&((m=n.form.get("name"))!=null&&m.dirty)?9:-1),s(7),S((C=n.form.get("severity"))==null?null:C.value),s(),b(17,(v=n.form.get("severity"))!=null&&v.invalid&&((v=n.form.get("severity"))!=null&&v.dirty)?17:-1),s(2),p("raised",!0)("rounded",!0),s(4),b(23,n.showPreview?23:-1),s(),b(24,(y=n.form.get("id"))!=null&&y.value?24:-1)}},dependencies:[B,Q,G,L,R,ie,K,Y,W,J,ee,te,oe,ne,je,Be,Ee,Zt,We,A,j,It,Tt]});let i=l;return i})();var Vi=["table"];function Di(i,l){i&1&&(r(0,"tr")(1,"th"),c(2,"Nombre"),a(),r(3,"th"),c(4,"Descripcion"),a(),r(5,"th"),c(6,"Color"),a(),r(7,"th"),c(8,"Vista previa"),a(),r(9,"th"),c(10,"Activo"),a(),r(11,"th",6),c(12,"Acciones"),a()())}function ki(i,l){if(i&1){let e=x();r(0,"p-button",14),g("onClick",function(){u(e);let o=d().$implicit,n=d();return _(n.onDeleteIncidentType(o))}),a()}i&2&&p("rounded",!0)("raised",!0)}function Mi(i,l){if(i&1){let e=x();r(0,"p-button",15),g("onClick",function(){u(e);let o=d().$implicit,n=d();return _(n.onActivateIncidentType(o))}),a()}i&2&&p("rounded",!0)("raised",!0)}var Kt=i=>({backgroundColor:i});function Fi(i,l){if(i&1){let e=x();r(0,"tr")(1,"td"),c(2),a(),r(3,"td"),c(4),a(),r(5,"td"),h(6,"div",7),a(),r(7,"td"),h(8,"p-tag",8),a(),r(9,"td"),h(10,"p-chip",9),a(),r(11,"td",10)(12,"div",11)(13,"p-button",12),g("onClick",function(){let n=u(e).$implicit,m=d();return _(m.openForm(n))}),a(),f(14,ki,1,2,"p-button",13)(15,Mi,1,2),a()()()}if(i&2){let e=l.$implicit;s(2),S(e.name),s(2),S(e.description),s(2),D(V(12,Kt,e.severity)),s(2),D(V(14,Kt,e.severity)),p("value",e.name),s(2),p("label",e.active?"Si":"No")("styleClass",e.active?"bg-blue-100 text-blue-600 text-sm shadow-3":"bg-red-100 text-red-600 text-sm shadow-3"),s(3),p("rounded",!0)("raised",!0),s(),b(14,e.active?14:15)}}function Pi(i,l){i&1&&(r(0,"tr")(1,"td",16),c(2,"No hay resultados"),a()())}var Ni=()=>({"min-width":"50rem"}),Oi=()=>["name"],ti=(()=>{let l=class l extends De{constructor(){super(),this.toolbarHeight=0,this.options={dataLoading:!0,showNewButton:!0,showSearch:!0},this.modalData={visible:!1,title:"",data:null,response:null},this.incidentTypes=[],this.incidentTypeService=w(de),this.messageService=w(re),this.confirmationService=w(Ie)}ngOnInit(){this.options.showSearch=!0,super.ngOnInit(),this.getIncidentTypes()}ngOnChanges(t){}onSearch(t){this.table.filterGlobal(t,"contains")}getIncidentTypes(){this.incidentTypeService.getIncidentTypes().subscribe(t=>{this.options.dataLoading=!0,this.incidentTypes=t.data,setTimeout(()=>{this.options.dataLoading=!1},300)})}onDeleteIncidentType(t){this.confirmationService.confirm({message:`\xBFEst\xE1s seguro de que quieres inhabilitar el tipo de incidente <span class="font-bold text-green-600">${t.name}</span>?`,header:"Confirmar inhabilitaci\xF3n del tipo de incidente",icon:"pi pi-info-circle",acceptButtonStyleClass:"p-button-danger",rejectButtonStyleClass:"p-button-secondary",acceptIcon:"pi pi-trash mr-2",acceptLabel:"S\xED",rejectLabel:"No",accept:()=>{this.incidentTypeService.deleteIncidentType(t.id).subscribe({next:o=>{this.messageService.add({summary:"\xC9xito",detail:o.message,severity:"success"}),this.getIncidentTypes()},error:o=>{this.messageService.add(this.handleError(o.error))}})}})}onActivateIncidentType(t){this.confirmationService.confirm({message:`\xBFEst\xE1s seguro de que quieres habilitar el tipo de incidente <span class="font-bold text-green-600">${t.name}</span>?`,header:"Confirmar habilitaci\xF3n del tipo de incidente",icon:"pi pi-info-circle",acceptButtonStyleClass:"p-button-success",rejectButtonStyleClass:"p-button-secondary",acceptIcon:"pi pi-check mr-2",acceptLabel:"S\xED",rejectLabel:"No",accept:()=>{this.incidentTypeService.reactivateIncidentType(t.id).subscribe({next:o=>{this.messageService.add({summary:"\xC9xito",detail:o.message,severity:"success"}),this.getIncidentTypes()},error:o=>{this.messageService.add(this.handleError(o.error))}})}})}openForm(t){this.modalData={visible:!0,title:t?"Editar tipo de incidente":"Crear tipo de incidente",data:t,response:null}}onHandleClose(){if(this.modalData.response){let t=this.modalData.response.id;if(t){let o={active:this.modalData.response.active,description:this.modalData.response.description,name:this.modalData.response.name,severity:this.modalData.response.severity};this.incidentTypeService.updateIncidentType(o,t).subscribe({next:n=>{this.reset(),this.messageService.add({severity:"success",detail:n.message,summary:"\xC9xito"}),this.getIncidentTypes()},error:n=>{this.messageService.add(this.handleError(n.error))}})}else{let o={name:this.modalData.response.name,description:this.modalData.response.description,severity:this.modalData.response.severity};this.incidentTypeService.createIncidentType(o).subscribe({next:n=>{this.reset(),this.getIncidentTypes(),this.messageService.add({severity:"success",detail:n.message,summary:"\xC9xito"})},error:n=>{this.messageService.add(this.handleError(n.error))}})}}else this.reset()}reset(){this.modalData={visible:!1,title:"",data:null,response:null}}handleError(t="Error al realizar la acci\xF3n, intentelo de nuevo m\xE1s tarde"){return{severity:"error",detail:t,summary:"Error"}}};l.\u0275fac=function(o){return new(o||l)},l.\u0275cmp=F({type:l,selectors:[["app-incident-type-managment"]],viewQuery:function(o,n){if(o&1&&T(Vi,5),o&2){let m;I(m=E())&&(n.table=m.first)}},inputs:{toolbarHeight:"toolbarHeight",options:"options"},standalone:!0,features:[ge,z,H],decls:6,vars:10,consts:[["styleClass","p-datatable-sm p-datatable-striped",3,"value","tableStyle","scrollable","scrollHeight","paginator","rows","globalFilterFields"],["table",""],["pTemplate","header"],["pTemplate","body"],["pTemplate","emptymessage"],[3,"modalData","handleClose"],[1,"w-fit"],[1,"w-2rem","h-2rem","border-circle"],["styleClass","uppercase",3,"value"],[3,"label","styleClass"],[1,"w-15rem"],[1,"flex","gap-2","w-fit"],["icon","pi pi-pencil","severity","warning","label","Editar","size","small",3,"rounded","raised","onClick"],["icon","pi pi-trash","severity","danger","label","Eliminar","size","small",3,"rounded","raised"],["icon","pi pi-trash","severity","danger","label","Eliminar","size","small",3,"rounded","raised","onClick"],["icon","pi pi-undo","severity","help","label","Reactivar","size","small",3,"rounded","raised","onClick"],["colspan","6"]],template:function(o,n){o&1&&(r(0,"p-table",0,1),f(2,Di,13,0,"ng-template",2)(3,Fi,16,16,"ng-template",3)(4,Pi,3,0,"ng-template",4),a(),r(5,"app-incident-type-form",5),g("handleClose",function(){return n.onHandleClose()}),a()),o&2&&(p("value",n.incidentTypes)("tableStyle",k(8,Ni))("scrollable",!0)("scrollHeight","calc(100vh - "+n.toolbarHeight+"px - 16.5rem)")("paginator",!0)("rows",10)("globalFilterFields",k(9,Oi)),s(5),p("modalData",n.modalData))},dependencies:[se,le,G,L,R,B,Lt,Rt,Jt,A,j]});let i=l;return i})();var ii=(()=>{let l=class l{constructor(){this.END_POINT=we.API_URL+"/protected/guard-incidents",this.http=w(xe)}findAllGuardIncidents(t,o,n,m,C,v){let y=new gt;return t&&(y=y.append("subject",t)),o&&(y=y.append("date",o.getTime().toString())),n&&(y=y.append("guard",n.toString())),m&&(y=y.append("type",m.toString())),C&&(y=y.append("status",C.toString())),v&&(y=y.append("page",v.toString())),this.http.get(this.END_POINT,{params:y})}createGuardIncident(t){let o=new FormData;o.append("subject",t.subject),o.append("description",t.description),o.append("date",t.date.getTime().toString()),o.append("guard",t.guard.toString()),o.append("type",t.type.toString()),t.files.forEach(m=>{o.append("files",m)});let n=new $e;return n.append("Content-Type","form-data"),this.http.post(this.END_POINT,o,{headers:n})}updateGuardIncident(t,o){let n=new FormData;n.append("subject",t.subject),n.append("description",t.description),n.append("date",t.date.getTime().toString()),n.append("guard",t.guard.toString()),n.append("type",t.type.toString()),n.append("status",t.status.toString()),t.observation&&n.append("observation",t.observation),t.deletedFiles&&t.deletedFiles.length>0&&t.deletedFiles.forEach(C=>{n.append("deletedFiles",C.toString())}),t.newFiles.forEach(C=>{n.append("newFiles",C)});let m=new $e;return m.append("Content-Type","form-data"),this.http.put(this.END_POINT+"/"+o,n,{headers:m})}deleteGuardIncident(t){return this.http.delete(this.END_POINT+"/"+t)}};l.\u0275fac=function(o){return new(o||l)},l.\u0275prov=_e({token:l,factory:l.\u0275fac,providedIn:"root"});let i=l;return i})();var ji=["search"],Ai=["fu"];function zi(i,l){if(i&1&&h(0,"app-error-input",6),i&2){let e=d();p("message",e.getErrorMessage("subject",e.form))}}function Ui(i,l){if(i&1&&h(0,"app-error-input",6),i&2){let e=d();p("message",e.getErrorMessage("subject",e.form))}}function qi(i,l){if(i&1&&h(0,"app-error-input",6),i&2){let e=d();p("message",e.getErrorMessage("description",e.form))}}function Qi(i,l){if(i&1&&h(0,"app-error-input",6),i&2){let e=d();p("message",e.getErrorMessage("guardToShow",e.form))}}var ni=i=>({backgroundColor:i,textWrap:"ellipsis"});function $i(i,l){if(i&1&&h(0,"p-tag",30,31),i&2){let e=d(2);D(V(3,ni,e.getSelectedType().severity)),p("value",e.getSelectedType().name||"Valor")}}function Xi(i,l){i&1&&(r(0,"span",32),c(1,"Seleccione un tipo"),a())}function Zi(i,l){if(i&1&&(r(0,"div",28),f(1,$i,2,5,"p-tag",29)(2,Xi,2,0),a()),i&2){let e=d(),t;s(),b(1,(t=e.form.get("type"))!=null&&t.value?1:2)}}function Yi(i,l){if(i&1&&(r(0,"div",28)(1,"div",33),h(2,"p-tag",30,31),a()()),i&2){let e=l.$implicit;s(2),D(V(3,ni,e.severity)),p("value",e.name||"Valor")}}function Wi(i,l){if(i&1&&h(0,"app-error-input",6),i&2){let e=d();p("message",e.getErrorMessage("type",e.form))}}function Ji(i,l){if(i&1){let e=x();r(0,"div",42)(1,"div",33)(2,"p-checkbox",43),g("ngModelChange",function(o){u(e);let n=d(3);return _(n.selectedFilesToDelete=o)}),a(),r(3,"label",44),c(4,"Eliminar"),a()(),h(5,"p-image",45),a()}if(i&2){let e=l.$implicit,t=d(3);s(2),p("inputId",e.id)("value",e.id)("ngModel",t.selectedFilesToDelete),s(),p("htmlFor",e.id),s(2),p("src",e.fileUrl)("preview",!0)}}function Ki(i,l){if(i&1&&(r(0,"div",8)(1,"label",40),c(2,"Evidencias"),a(),r(3,"p-carousel",41),f(4,Ji,6,6,"ng-template",21),a()()),i&2){let e=d(2);s(3),p("value",e.modalData.data.evidences)("numVisible",3)("numScroll",3)("circular",!1)("responsiveOptions",e.responsiveOptions)}}function en(i,l){if(i&1&&(r(0,"div",28),h(1,"div",46),r(2,"div"),c(3),a()()),i&2){let e=l.$implicit,t=d(2);s(),p("ngClass",t.getRowCellClass(e.value)),s(2),S(e.label)}}function tn(i,l){if(i&1&&h(0,"app-error-input",6),i&2){let e=d(2);p("message",e.getErrorMessage("status",e.form))}}function nn(i,l){if(i&1&&(f(0,Ki,5,5,"div",34),r(1,"div",17)(2,"label",35),c(3,"Estado"),a(),r(4,"p-listbox",36),f(5,en,4,2,"ng-template",21),a(),f(6,tn,1,1,"app-error-input",6),a(),r(7,"div",37)(8,"span",3),h(9,"textarea",38),r(10,"label",39),c(11,"Observaci\xF3n"),a()()()),i&2){let e=d(),t;b(0,e.modalData.data.evidences.length>0?0:-1),s(4),p("options",e.statusList)("emptyMessage","No hay datos para mostrar"),s(2),b(6,(t=e.form.get("status"))!=null&&t.invalid&&((t=e.form.get("status"))!=null&&t.dirty)?6:-1)}}function on(i,l){i&1&&(r(0,"div",50),h(1,"p-progressSpinner",51),a())}function rn(i,l){i&1&&(r(0,"tr")(1,"th"),c(2,"Foto"),a(),r(3,"th"),c(4,"Nombre completo"),a(),r(5,"th"),c(6,"D.N.I."),a()())}function an(i,l){if(i&1&&(r(0,"tr",56)(1,"td"),h(2,"img",57),a(),r(3,"td"),c(4),a(),r(5,"td"),c(6),a()()),i&2){let e=l.$implicit,t=l.$implicit;p("pSelectableRow",t),s(2),p("src",e.photoUrl,pe),s(2),S(e.fullName),s(2),S(e.dni)}}function ln(i,l){if(i&1){let e=x();r(0,"div",50)(1,"p-paginator",58),g("onPageChange",function(o){u(e);let n=d(4);return _(n.onPageChange(o))}),a()()}if(i&2){let e=d(4);s(),p("rows",e.rows)("first",e.first)("totalRecords",e.totalItems)("currentPageReportTemplate","{currentPage} de {totalPages} p\xE1ginas ({totalRecords} registros)")("showJumpToPageDropdown",!0)}}function sn(i,l){i&1&&(r(0,"div",50)(1,"p",59),c(2,"No hay datos para mostrar"),a()())}function dn(i,l){if(i&1&&f(0,ln,2,5,"div",49)(1,sn,3,0),i&2){let e=d(3);b(0,e.guards.length>0?0:1)}}var pn=()=>({"min-width":"30rem"});function cn(i,l){if(i&1){let e=x();r(0,"p-table",52),g("selectionChange",function(o){u(e);let n=d(2);return _(n.selectedGuard=o)})("onRowSelect",function(o){u(e);let n=d(2),m=P(41);return _(n.onRowSelect(o,m))}),f(1,rn,7,0,"ng-template",53)(2,an,7,4,"ng-template",54)(3,dn,2,1,"ng-template",55),a()}if(i&2){let e=d(2);p("value",e.guards)("tableStyle",k(5,pn))("scrollable",!0)("scrollHeight","22vh")("selection",e.selectedGuard)}}function mn(i,l){if(i&1){let e=x();r(0,"input",47,48),g("input",function(){u(e);let o=P(1),n=d();return _(n.onSearchGuard(o.value))}),a(),f(2,on,2,0,"div",49)(3,cn,4,6)}if(i&2){let e=d();s(2),b(2,e.dataLoading?2:3)}}function un(i,l){if(i&1){let e=x();r(0,"p-button",60),g("onClick",function(){u(e);let o=d();return _(o.handleAccept())}),a(),r(1,"p-button",61),g("onClick",function(){u(e);let o=d();return _(o.handleClose.emit())}),a()}i&2&&(p("raised",!0)("rounded",!0),s(),p("raised",!0)("rounded",!0))}var oi=(()=>{let l=class l{constructor(){this.modalData={},this.handleClose=new q,this.fb=w(Se),this.getErrorMessage=Ve,this.guardService=w(Ue),this.messageService=w(re),this.typeSerivce=w(de),this.guards=[],this.dataLoading=!0,this.selectedGuard={},this.first=0,this.rows=10,this.totalItems=0,this.form=this.fb.group({id:[""],subject:["",M.required],description:["",M.required],observation:[""],date:["",M.required],guard:["",M.required],guardToShow:["",M.required],type:["",M.required],files:[[]],status:[""],deletedFiles:[{}]}),this.selectedFilesToDelete=[],this.statusList=[{label:"PENDIENTE",value:$.PENDING},{label:"RESUELTO",value:$.RESOLVED},{label:"SIN RESOLVER",value:$.UNRESOLVED}],this.responsiveOptions=[{breakpoint:"1199px",numVisible:1,numScroll:1},{breakpoint:"991px",numVisible:2,numScroll:1},{breakpoint:"767px",numVisible:1,numScroll:1}],this.types=[]}ngOnChanges(t){t.modalData&&(this.fileUpload&&this.fileUpload.clear(),this.selectedGuard={},this.first=0,this.selectedFilesToDelete=[],this.getGuards(),this.getTypes(),this.form.reset(),this.modalData.data?(this.form.patchValue(tt(et({},this.modalData.data),{date:new Date(this.modalData.data.date),guard:this.modalData.data?.guard?this.modalData.data.guard.id:null,guardToShow:this.modalData.data?.guard?this.modalData.data.guard.fullName+" - "+this.modalData.data.guard.dni:null})),this.selectedGuard=this.modalData.data?.guard,this.form.get("status")?.setValidators(M.required),this.form.get("status")?.updateValueAndValidity({onlySelf:!0})):this.form.get("status")?.clearValidators())}handleAccept(){this.form.valid?(this.form.patchValue({deletedFiles:this.selectedFilesToDelete}),this.modalData.response=this.form.value,this.handleClose.emit()):Object.values(this.form.controls).forEach(t=>{t.invalid&&(t.markAsDirty(),t.updateValueAndValidity({onlySelf:!0}))})}getTypes(){this.typeSerivce.getActiveIncidentTypes().subscribe({next:t=>{this.types=t.data},error:t=>{this.messageService.add({severity:"error",summary:"Error",detail:"No se pudieron obtener los tipos de incidentes"})}})}getGuards(t,o){this.guardService.findAllActiveGuards(t,o).subscribe({next:n=>{this.dataLoading=!0,this.totalItems=n.data.totalItems,this.guards=n.data.content,setTimeout(()=>{this.dataLoading=!1},300)},error:n=>{this.messageService.add({severity:"error",summary:"Error",detail:"No se pudieron obtener los guardias"})}})}getSelectedType(){return this.form.get("type")?.value}onSearchGuard(t){this.getGuards(t)}onRowSelect(t,o){this.selectedGuard=t.data,this.form.patchValue({guard:this.selectedGuard.id.toString()}),this.form.patchValue({guardToShow:this.selectedGuard.fullName+" - "+this.selectedGuard.dni}),o.hide()}onPageChange(t){this.first=t.first;let o=this.search.nativeElement.value;this.getGuards(o,t.page)}setImages(t){this.form.patchValue({files:t.currentFiles})}getRowCellClass(t){return Le(t)}};l.\u0275fac=function(o){return new(o||l)},l.\u0275cmp=F({type:l,selectors:[["app-incident-form"]],viewQuery:function(o,n){if(o&1&&(T(ji,5),T(Ai,5)),o&2){let m;I(m=E())&&(n.search=m.first),I(m=E())&&(n.fileUpload=m.first)}},inputs:{modalData:"modalData"},outputs:{handleClose:"handleClose"},standalone:!0,features:[z,H],decls:44,vars:24,consts:[["styleClass","w-10 md:w-8 lg:w-8","position","top",3,"header","visible","modal","draggable","resizable","autofocus","visibleChange","onHide"],[1,"pt-4","grid","row-gap-3","nested-grid",3,"formGroup"],[1,"col-12","lg:col-6"],[1,"p-float-label"],["pInputText","","id","subject","formControlName","subject","autocomplete","off","type","text",1,"w-full"],["for","subject"],[3,"message"],["formControlName","date","id","date","dateFormat","dd/mm/yy","appendTo","body","styleClass","w-full",3,"showTime","showButtonBar"],[1,"col-12"],["id","description","pInputTextarea","","formControlName","description",1,"w-full",3,"rows"],["for","description"],[1,"col-12","lg:col-5"],["pInputText","","id","guardToShow","formControlName","guardToShow",1,"w-full",3,"readOnly"],["for","guardToShow"],[1,"col-12","-mt-3","lg:col-3","lg:mt-0"],["pButton","","title","Cambiar guardia","type","button","icon","pi pi-arrow-right-arrow-left","label","Cambiar",1,"p-button-rounded","p-button-sm","p-button-secondary","w-full",3,"click"],["btn",""],[1,"col-12","lg:col-4","relative"],["for","severity",1,"text-xs","text-gray-500","block","ml-2","absolute","left-0",2,"top","-1rem"],["appendTo","body","formControlName","type","placeholder","Seleccine un tipo","optionLabel","name","styleClass","w-full",3,"options"],["pTemplate","selectedItem"],["pTemplate","item"],["mode","advanced","chooseLabel","Subir evidencias","accept","image/*","chooseStyleClass","p-button-raised p-button-secondary w-full","removeStyleClass","p-button-raised p-button-danger p-button-rounded",3,"maxFileSize","showUploadButton","showCancelButton","multiple","onSelect"],["fu",""],["styleClass","bg-gray-200 w-11 lg:w-6",3,"showCloseIcon","dismissable"],["op1",""],["pTemplate","content"],["pTemplate","footer"],[1,"flex","align-items-center","gap-2"],["styleClass","uppercase",3,"value","style"],["styleClass","uppercase",3,"value"],["tag",""],[1,"text-gray-500"],[1,"flex","gap-2"],["class","col-12"],["for","status",1,"text-xs","text-gray-500","block","ml-3","absolute","left-0",2,"top","-1rem"],["formControlName","status","id","status",3,"options","emptyMessage"],[1,"col-12","lg:col-8"],["id","observation","rows","7","formControlName","observation","pInputTextarea","",1,"w-full"],["for","observation"],[1,"text-xs","text-gray-500","block","ml-2"],[3,"value","numVisible","numScroll","circular","responsiveOptions"],[1,"border-1","surface-border","border-round","m-2","p-2","text-center","flex","flex-column","gap-2"],["value","Eliminar","formControlName","deletedFiles",3,"inputId","value","ngModel","ngModelChange"],[1,"text-sm","text-red-400",3,"htmlFor"],["alt","Evidencia","imageClass","w-10rem h-10rem","appendTo","body",3,"src","preview"],[1,"w-1rem","h-1rem","border-circle",3,"ngClass"],["pInputText","","placeholder","Buscar",1,"p-inputtext-sm","mb-2",3,"input"],["search",""],["class","flex justify-content-center"],[1,"flex","justify-content-center"],["styleClass","w-14rem h-14rem","strokeWidth","4","fill","var(--surface-ground)","animationDuration",".5s"],["styleClass","p-datatable-sm p-datatable-striped","selectionMode","single",3,"value","tableStyle","scrollable","scrollHeight","selection","selectionChange","onRowSelect"],["pTemplate","header"],["pTemplate","body"],["pTemplate","summary"],[3,"pSelectableRow"],["alt","Foto de perfil",1,"w-3rem","max-h-4rem","rounded-full",3,"src"],[3,"rows","first","totalRecords","currentPageReportTemplate","showJumpToPageDropdown","onPageChange"],[1,"text-lg","py-2"],["label","Aceptar","severity","success",3,"raised","rounded","onClick"],["label","Cancelar","severity","danger",3,"raised","rounded","onClick"]],template:function(o,n){if(o&1){let m=x();r(0,"p-dialog",0),g("visibleChange",function(v){return n.modalData.visible=v})("onHide",function(){return n.handleClose.emit()}),r(1,"form",1)(2,"div",2)(3,"span",3),h(4,"input",4),r(5,"label",5),c(6,"Asunto"),a()(),f(7,zi,1,1,"app-error-input",6),a(),r(8,"div",2)(9,"span",3),h(10,"p-calendar",7),r(11,"label",5),c(12,"Fecha & hora del incidente"),a()(),f(13,Ui,1,1,"app-error-input",6),a(),r(14,"div",8)(15,"span",3),h(16,"textarea",9),r(17,"label",10),c(18,"Descripci\xF3n"),a()(),f(19,qi,1,1,"app-error-input",6),a(),r(20,"div",11)(21,"span",3),h(22,"input",12),r(23,"label",13),c(24,"Guardia que reporta"),a()(),f(25,Qi,1,1,"app-error-input",6),a(),r(26,"div",14)(27,"button",15,16),g("click",function(v){u(m);let y=P(41);return _(y.toggle(v))}),a()(),r(29,"div",17)(30,"label",18),c(31,"Tipo de incidente"),a(),r(32,"p-dropdown",19),f(33,Zi,3,1,"ng-template",20)(34,Yi,4,5,"ng-template",21),a(),f(35,Wi,1,1,"app-error-input",6),a(),r(36,"div",8)(37,"p-fileUpload",22,23),g("onSelect",function(v){return n.setImages(v)}),a()(),f(39,nn,12,4),r(40,"p-overlayPanel",24,25),f(42,mn,4,1,"ng-template",26),a()(),f(43,un,2,4,"ng-template",27),a()}if(o&2){let m,C,v,y,N;p("header",n.modalData.title)("visible",n.modalData.visible)("modal",!0)("draggable",!1)("resizable",!1)("autofocus",!1),s(),p("formGroup",n.form),s(6),b(7,(m=n.form.get("subject"))!=null&&m.invalid&&((m=n.form.get("subject"))!=null&&m.dirty)?7:-1),s(3),p("showTime",!0)("showButtonBar",!0),s(3),b(13,(C=n.form.get("subject"))!=null&&C.invalid&&((C=n.form.get("subject"))!=null&&C.dirty)?13:-1),s(3),p("rows",7),s(3),b(19,(v=n.form.get("description"))!=null&&v.invalid&&((v=n.form.get("description"))!=null&&v.dirty)?19:-1),s(3),p("readOnly",!0),s(3),b(25,(y=n.form.get("guardToShow"))!=null&&y.invalid&&((y=n.form.get("guardToShow"))!=null&&y.dirty)?25:-1),s(7),p("options",n.types),s(3),b(35,(N=n.form.get("type"))!=null&&N.invalid&&((N=n.form.get("type"))!=null&&N.dirty)?35:-1),s(2),p("maxFileSize",5e6)("showUploadButton",!1)("showCancelButton",!1)("multiple",!0),s(2),b(39,n.modalData.data!=null&&n.modalData.data.id?39:-1),s(),p("showCloseIcon",!0)("dismissable",!1)}},dependencies:[B,Q,G,L,ae,R,ie,K,Y,W,J,ee,te,Ee,oe,ne,Oe,Ne,je,Be,Me,ke,ze,Ae,se,le,Re,Ge,He,Fe,Pe,A,j,Nt,Pt,Ut,zt,ye,Qt,qt,jt,Bt,Ft,Mt]});let i=l;return i})();var _n=i=>({backgroundColor:i,textWrap:"ellipsis"});function hn(i,l){if(i&1&&(r(0,"p"),c(1," Tipo: "),h(2,"p-tag",15,16),a()),i&2){let e=d();s(2),D(V(3,_n,e.guardIncident.type.severity)),p("value",e.guardIncident.type.name||"Valor")}}function gn(i,l){if(i&1&&(r(0,"p",10),c(1," Guardia que reporto: "),r(2,"span",11),c(3),a()()),i&2){let e=d();s(3),S(e.guardIncident.guard.fullName)}}function fn(i,l){if(i&1&&(r(0,"p"),c(1),a()),i&2){let e=d();s(),S(e.guardIncident.observation)}}function Cn(i,l){i&1&&(r(0,"p"),c(1,"No hay observaciones"),a())}var vn=()=>({size:"A4",margin:"0"}),yn=()=>({"-webkit-print-color-adjust":"exact"}),bn=()=>({padding:"0 !important",border:"none !important"}),xn=()=>({"border-top":"1px solid #e5e7eb !important","border-top-left-radius":"6px !important","border-top-right-radius":"6px !important"}),wn=()=>({"border-top-left-radius":"6px !important","border-top-right-radius":"6px !important"}),Sn=(i,l,e,t,o)=>({"@page":i,body:l,".p-editor-toolbar.ng-star-inserted.ql-toolbar.ql-snow":e,".p-editor-container .p-editor-content":t,".p-editor-container .p-editor-content .ql-editor":o});function Tn(i,l){if(i&1){let e=x();r(0,"div",17),h(1,"button",18),r(2,"p-button",19),g("click",function(){u(e);let o=d();return _(o.visible=!1)}),a()()}if(i&2){let e=d();s(),p("printSectionId","print-section")("useExistingCss",!0)("previewOnly",!1)("openNewTab",!1)("printTitle",e.guardIncident.subject)("printStyle",pt(14,Sn,k(9,vn),k(10,yn),k(11,bn),k(12,xn),k(13,wn)))("bodyClass","p-2 bg-teal-50"),s(),p("rounded",!0)("raised",!0)}}var ri=(()=>{let l=class l{constructor(){this.guardIncident={},this.visible=!1,this.currentPresident={},this.userService=w(At)}ngOnChanges(t){this.userService.findPresident().subscribe(o=>{this.currentPresident=o.data}),t.guardIncident&&this.guardIncident}};l.\u0275fac=function(o){return new(o||l)},l.\u0275cmp=F({type:l,selectors:[["app-incident-view"]],inputs:{guardIncident:"guardIncident",visible:"visible"},standalone:!0,features:[z,H],decls:42,vars:17,consts:[["styleClass"," w-11 lg:w-8 h-full","contentStyleClass","",3,"modal","draggable","resizable","visible","visibleChange"],["id","print-section"],[1,"flex","justify-content-center","relative"],["src","assets/images/logo-removebg.png","alt","logo",1,"w-8rem","mt-2","ml-2","absolute","top-0","left-0"],[1,"text-5xl","font-bold","mb-4"],[1,"flex","flex-column","gap-2"],[1,"text-center","font-bold","px-6","py-2","bg-teal-700","text-white","w-fit","m-auto","uppercase","mb-3"],[1,"text-xl","text-center","mb-2"],[1,"text-teal-700"],[1,"flex","justify-content-between"],[1,"font-bold"],[1,"font-normal"],["class","font-bold"],[1,"text-sm","text-center"],["pTemplate","footer"],["styleClass","uppercase",3,"value"],["tag",""],[1,"flex","gap-2","justify-content-end","align-items-center"],["title","Descargar en PDF","pButton","","label","Descargar","icon","pi pi-file-pdf","ngxPrint","",1,"p-button","p-button-raised","p-button-rounded","p-button-secondary",3,"printSectionId","useExistingCss","previewOnly","openNewTab","printTitle","printStyle","bodyClass"],["label","Cerrar","icon","pi pi-times","severity","danger",3,"rounded","raised","click"]],template:function(o,n){o&1&&(r(0,"p-dialog",0),g("visibleChange",function(C){return n.visible=C}),r(1,"div",1)(2,"div",2),h(3,"img",3),r(4,"h1",4),c(5,"PORTAL DE LA VI\xD1A"),a()(),r(6,"section",5)(7,"h1",6),c(8," Incidente de guardian\xEDa "),a(),r(9,"h2",7),c(10," Asunto: "),r(11,"span",8),c(12),a()(),r(13,"div",9)(14,"p",10),c(15," Fecha & hora del incidente: "),r(16,"span",11),c(17),Ce(18,"date"),a()(),f(19,hn,4,5,"p"),a(),f(20,gn,4,1,"p",12),r(21,"p",10),c(22,"Descripci\xF3n del incidente:"),a(),r(23,"p"),c(24),a(),r(25,"p",10),c(26,"Observaciones:"),a(),f(27,fn,2,1,"p")(28,Cn,2,0),h(29,"br")(30,"br")(31,"br"),r(32,"div",13)(33,"p",10),c(34),a(),r(35,"p"),c(36),a(),r(37,"p"),c(38),a(),r(39,"p"),c(40),a()()()(),f(41,Tn,3,20,"ng-template",14),a()),o&2&&(p("modal",!0)("draggable",!1)("resizable",!1)("visible",n.visible),s(12),S(n.guardIncident.subject),s(5),S(ve(18,14,n.guardIncident.date,"dd 'de' MMMM 'del' yyyy 'a las' HH:mm ")),s(2),b(19,n.guardIncident.type?19:-1),s(),b(20,n.guardIncident.guard?20:-1),s(4),S(n.guardIncident.description),s(3),b(27,n.guardIncident.observation?27:28),s(7),X(" ",n.currentPresident.names+" "+n.currentPresident.surnames," "),s(2),X("D.N.I.: ",n.currentPresident.dni,""),s(2),X("Telf.: ",n.currentPresident.phone,""),s(2),X("Email.: ",n.currentPresident.email,""))},dependencies:[B,Q,G,L,ae,R,Ot,be,A,j,Ht]});let i=l;return i})();var In=["container"],En=["incidentTypeManagment"],Vn=["iv"],Dn=["search"],Ke=i=>({backgroundColor:i,textWrap:"ellipsis"});function kn(i,l){if(i&1){let e=x();h(0,"p-tag",40),r(1,"i",41),g("click",function(o){u(e),d(2);let n=P(10);return _(n.clear(o))}),a()}if(i&2){let e=d(3);D(V(3,Ke,e.getSelectedType().severity)),p("value",e.getSelectedType().name||void 0)}}function Mn(i,l){i&1&&(r(0,"span",42),c(1,"Seleccione un tipo"),a())}function Fn(i,l){if(i&1&&(r(0,"div",39),f(1,kn,2,5)(2,Mn,2,0),a()),i&2){let e=d(2),t;s(),b(1,(t=e.filterForm.get("type"))!=null&&t.value?1:2)}}function Pn(i,l){if(i&1&&(r(0,"div",39)(1,"div",43),h(2,"p-tag",44),a()()),i&2){let e=l.$implicit;s(2),D(V(3,Ke,e.severity)),p("value",e.name||"Valor")}}function Nn(i,l){if(i&1){let e=x();h(0,"p-tag",45),r(1,"i",41),g("click",function(o){u(e),d(3);let n=P(14);return _(n.clear(o))}),a()}if(i&2){let e=d(4);p("styleClass",e.getTagClass(e.getSelectedStatus()))("value",e.getGuardActivityStatusSpanishTranslation(e.getSelectedStatus())||void 0)}}function On(i,l){if(i&1&&f(0,Nn,2,2),i&2){let e=d(3);b(0,e.getSelectedStatus()?0:-1)}}function Hn(i,l){i&1&&(r(0,"span",42),c(1,"Seleccione un estado"),a())}function Gn(i,l){if(i&1&&(r(0,"div",39),f(1,On,1,1)(2,Hn,2,0),a()),i&2){let e=d(2),t;s(),b(1,(t=e.filterForm.get("status"))!=null&&t.value?1:2)}}function Rn(i,l){if(i&1&&(r(0,"div",39)(1,"div",43),h(2,"p-tag",45),a()()),i&2){let e=l.$implicit,t=d(2);s(2),p("styleClass",t.getTagClass(e.value))("value",e.label||"Valor")}}function Ln(i,l){i&1&&(r(0,"div",49),h(1,"p-progressSpinner",50),a())}function Bn(i,l){i&1&&(r(0,"tr")(1,"th"),c(2,"Foto"),a(),r(3,"th"),c(4,"Nombre completo"),a(),r(5,"th"),c(6,"D.N.I."),a()())}function jn(i,l){if(i&1&&(r(0,"tr",55)(1,"td"),h(2,"img",56),a(),r(3,"td"),c(4),a(),r(5,"td"),c(6),a()()),i&2){let e=l.$implicit,t=l.$implicit;p("pSelectableRow",t),s(2),p("src",e.photoUrl,pe),s(2),S(e.fullName),s(2),S(e.dni)}}function An(i,l){if(i&1){let e=x();r(0,"div",49)(1,"p-paginator",57),g("onPageChange",function(o){u(e);let n=d(5);return _(n.onPageChangeGuard(o))}),a()()}if(i&2){let e=d(5);s(),p("rows",e.rows)("first",e.first)("totalRecords",e.totalItems)("currentPageReportTemplate","{currentPage} de {totalPages} p\xE1ginas ({totalRecords} registros)")("showJumpToPageDropdown",!0)}}function zn(i,l){i&1&&(r(0,"div",49)(1,"p",58),c(2,"No hay datos para mostrar"),a()())}function Un(i,l){if(i&1&&f(0,An,2,5,"div",48)(1,zn,3,0),i&2){let e=d(4);b(0,e.guards.length>0?0:1)}}var qn=()=>({"min-width":"30rem"});function Qn(i,l){if(i&1){let e=x();r(0,"p-table",51),g("selectionChange",function(o){u(e);let n=d(3);return _(n.selectedGuard=o)})("onRowSelect",function(o){u(e),d(2);let n=P(28),m=d();return _(m.onRowSelect(o,n))}),f(1,Bn,7,0,"ng-template",52)(2,jn,7,4,"ng-template",53)(3,Un,2,1,"ng-template",54),a()}if(i&2){let e=d(3);p("value",e.guards)("tableStyle",k(5,qn))("scrollable",!0)("scrollHeight","22vh")("selection",e.selectedGuard)}}function $n(i,l){if(i&1){let e=x();r(0,"input",46,47),g("input",function(){u(e);let o=P(1),n=d(2);return _(n.onSearchGuard(o.value))}),a(),f(2,Ln,2,0,"div",48)(3,Qn,4,6)}if(i&2){let e=d(2);s(2),b(2,e.dataLoading?2:3)}}function Xn(i,l){if(i&1){let e=x();r(0,"div",2)(1,"p-button",14,15),g("onClick",function(o){u(e);let n=P(4),m=d();return n.toggle(o),m.getGuards(),_(m.getTypes())}),a(),r(3,"p-overlayPanel",16,17)(5,"form",18)(6,"div",19),h(7,"p-calendar",20),r(8,"div",21)(9,"p-dropdown",22,23),g("onClear",function(){u(e);let o=d(),n;return _((n=o.filterForm.get("type"))==null?null:n.setValue(null))}),f(11,Fn,3,1,"ng-template",24)(12,Pn,3,5,"ng-template",12),a(),r(13,"p-dropdown",25,26),g("onClear",function(){u(e);let o=d(),n;return _((n=o.filterForm.get("status"))==null?null:n.setValue(null))}),f(15,Gn,3,1,"ng-template",24)(16,Rn,3,2,"ng-template",12),a()(),r(17,"div",27)(18,"p-inputGroup"),h(19,"input",28),r(20,"button",29),g("click",function(){u(e);let o=d();return _(o.clearGuardOnFilter())}),a()(),r(21,"button",30,31),g("click",function(o){u(e);let n=P(28);return _(n.toggle(o))}),a()(),h(23,"input",32),r(24,"div",33)(25,"p-button",34),g("onClick",function(){u(e);let o=d();return _(o.onClearFilter())}),a(),r(26,"p-button",35),g("onClick",function(){u(e);let o=d();return _(o.onFilter())}),a()(),r(27,"p-overlayPanel",36,37),f(29,$n,4,1,"ng-template",38),a()()()()()}if(i&2){let e=d();s(),p("rounded",!0)("raised",!0)("text",!0),s(2),p("showCloseIcon",!0)("dismissable",!1),s(2),p("formGroup",e.filterForm),s(4),p("options",e.types),s(4),p("options",e.statusList),s(6),p("readOnly",!0),s(6),p("outlined",!0),s(),p("outlined",!0),s(),p("showCloseIcon",!0)("dismissable",!1)}}function Zn(i,l){i&1&&h(0,"app-data-loader")}function Yn(i,l){if(i&1&&h(0,"app-incident-type-managment",5,59),i&2){let e=d();p("toolbarHeight",e.toolbarHeight)("options",e.containerOptions)}}function Wn(i,l){i&1&&(r(0,"tr"),h(1,"th",61),r(2,"th"),c(3,"Fecha & hora"),a(),r(4,"th"),c(5,"Asunto"),a(),r(6,"th"),c(7,"Guardia que reporta"),a(),r(8,"th"),c(9,"Descripci\xF3n"),a(),r(10,"th"),c(11,"Tipo de Incidente"),a(),r(12,"th"),c(13,"Estado"),a(),r(14,"th"),c(15,"Observaciones"),a(),r(16,"th"),c(17,"Evidencias"),a(),r(18,"th"),c(19,"Acciones"),a()())}function Jn(i,l){if(i&1){let e=x();r(0,"p-button",70),g("click",function(){u(e);let o=d().$implicit,n=d(2);return _(n.onShowDialogPanel(o.description,"D"))}),a()}i&2&&p("rounded",!0)("text",!0)("raised",!0)}function Kn(i,l){i&1&&c(0," No hay descripci\xF3n ")}function eo(i,l){if(i&1){let e=x();r(0,"p-button",70),g("click",function(){u(e);let o=d().$implicit,n=d(2);return _(n.onShowDialogPanel(o.observation,"O"))}),a()}i&2&&p("rounded",!0)("text",!0)("raised",!0)}function to(i,l){i&1&&c(0," No hay observaciones ")}function io(i,l){if(i&1){let e=x();r(0,"p-button",71),g("click",function(){u(e);let o=d().$implicit,n=d(2);return _(n.onDisplayGallery(o.evidences))}),a()}i&2&&p("rounded",!0)("text",!0)("raised",!0)}function no(i,l){i&1&&c(0," No hay evidencias ")}function oo(i,l){if(i&1){let e=x();r(0,"tr"),h(1,"td"),r(2,"td"),c(3),Ce(4,"date"),a(),r(5,"td"),c(6),a(),r(7,"td"),c(8),a(),r(9,"td"),f(10,Jn,1,3,"p-button",62)(11,Kn,1,0),a(),r(12,"td"),h(13,"p-tag",44,63),a(),r(15,"td",64),h(16,"p-tag",65),a(),r(17,"td"),f(18,eo,1,3,"p-button",62)(19,to,1,0),a(),r(20,"td"),f(21,io,1,3,"p-button",66)(22,no,1,0),a(),r(23,"td")(24,"div",43)(25,"p-button",67),g("onClick",function(){let n=u(e).$implicit,m=d(2);return _(m.onViewIncident(n))}),a(),r(26,"p-button",68),g("onClick",function(){let n=u(e).$implicit,m=d(2);return _(m.onOpenForm(n))}),a(),r(27,"p-button",69),g("onClick",function(){let n=u(e).$implicit,m=d(2);return _(m.onDelete(n))}),a()()()()}if(i&2){let e=l.$implicit,t=d(2);ce(t.getRowClass(e.status)),s(),ce(t.getRowCellClass(e.status)),s(2),S(ve(4,21,e.date,"dd/MM/yyyy HH:mm")),s(3),S(e.subject),s(2),S(e.guard.fullName),s(2),b(10,e.description?10:11),s(3),D(V(24,Ke,e.type.severity)),p("value",e.type.name||"Valor"),s(3),p("value",t.getGuardActivityStatusSpanishTranslation(e.status))("styleClass",t.getTagClass(e.status)),s(2),b(18,e.observation?18:19),s(3),b(21,e.evidences.length>0?21:22),s(4),p("rounded",!0)("raised",!0),s(),p("rounded",!0)("raised",!0),s(),p("rounded",!0)("raised",!0)}}function ro(i,l){if(i&1){let e=x();r(0,"div",49)(1,"p-paginator",72),g("onPageChange",function(o){u(e);let n=d(3);return _(n.onPageChange(o))}),a()()}if(i&2){let e=d(3);s(),p("rows",e.rows)("showJumpToPageDropdown",!0)("currentPageReportTemplate","{currentPage} de {totalPages} p\xE1ginas ({totalRecords} registros)")("first",e.first)("totalRecords",e.totalItems)}}function ao(i,l){i&1&&(r(0,"div",49)(1,"p",73),c(2,"No hay datos para mostrar"),a()())}function lo(i,l){if(i&1&&f(0,ro,2,5,"div",48)(1,ao,3,0),i&2){let e=d(2);b(0,e.guardIncidents.length>0?0:1)}}var so=()=>({"min-width":"50rem"});function po(i,l){if(i&1&&(r(0,"p-table",60),f(1,Wn,20,0,"ng-template",52)(2,oo,28,26,"ng-template",53)(3,lo,2,1,"ng-template",54),a()),i&2){let e=d();p("value",e.guardIncidents)("tableStyle",k(4,so))("scrollable",!0)("scrollHeight","calc(100vh - "+e.toolbarHeight+"px - 18.0rem)")}}function co(i,l){if(i&1){let e=x();r(0,"div",74)(1,"h2",75),c(2),a(),r(3,"p",76),c(4),a(),r(5,"div",77)(6,"p-button",78),g("onClick",function(){u(e);let o=d();return _(o.dialogVisible=!1)}),a()()()}if(i&2){let e=d();s(2),S(e.dialogTitle),s(2),X(" ",e.dialogContent," "),s(2),p("raised",!0)("rounded",!0)}}var mo=()=>({width:"100%"});function uo(i,l){if(i&1&&h(0,"img",79),i&2){let e=l.$implicit;D(k(3,mo)),p("src",e.itemImageSrc,pe)}}var Ba=(()=>{let l=class l extends De{constructor(){super(),this.toogleManagment=!1,this.toolbarHeight=0,this.first=0,this.rows=10,this.totalItems=0,this.containerOptions={dataLoading:!0,showNewButton:!0,showSearch:!1},this.modalData={visible:!1,title:"",data:null,response:null},this.guardIncidents=[],this.guards=[],this.selectedGuard={},this.firstGuardService=0,this.rowsGuardService=10,this.totalItemsGuardService=0,this.dataLoading=!0,this.statusList=[{label:"PENDIENTE",value:$.PENDING},{label:"RESUELTO",value:$.RESOLVED},{label:"SIN RESOLVER",value:$.UNRESOLVED}],this.types=[],this.displayGallery=!1,this.responsiveOptions=[{breakpoint:"1500px",numVisible:5},{breakpoint:"1024px",numVisible:3},{breakpoint:"768px",numVisible:2},{breakpoint:"560px",numVisible:1}],this.cdr=w(he),this.fb=w(Ct),this.messageService=w(re),this.confirmationService=w(Ie),this.guardIncidentService=w(ii),this.guardService=w(Ue),this.typeSerivce=w(de),this.filterForm=this.fb.group({subject:[""],date:[],guard:[""],type:[],status:[],guardToShow:[""]}),this.dialogContent="",this.dialogVisible=!1,this.dialogTitle="",this.galleryImages=[]}ngAfterViewInit(){this.toolbarHeight=this.container.toolbar.getBlockableElement().clientHeight,this.cdr.detectChanges()}ngOnInit(){super.ngOnInit(),this.getGuardIncidents()}getTypes(){this.typeSerivce.getActiveIncidentTypes().subscribe({next:t=>{this.types=t.data},error:t=>{this.messageService.add({severity:"error",summary:"Error",detail:"No se pudieron obtener los tipos de incidentes"})}})}getSelectedType(){return this.filterForm.get("type")?.value}getSelectedStatus(){let t=this.filterForm.get("status").value;return t?t.value:null}getGuards(t,o){this.guardService.findAllActiveGuards(t,o).subscribe({next:n=>{this.dataLoading=!0,this.totalItems=n.data.totalItems,this.guards=n.data.content,setTimeout(()=>{this.dataLoading=!1},300)},error:n=>{this.messageService.add({severity:"error",summary:"Error",detail:"No se pudieron obtener los guardias"})}})}onSearchGuard(t){this.getGuards(t)}onClearFilter(){this.filterForm.reset(),this.selectedGuard={}}onRowSelect(t,o){this.selectedGuard=t.data,this.filterForm.patchValue({guard:this.selectedGuard.id.toString()}),this.filterForm.patchValue({guardToShow:this.selectedGuard.fullName+" - "+this.selectedGuard.dni}),o.hide()}onPageChangeGuard(t){this.first=t.first;let o=this.search.nativeElement.value;this.getGuards(o,t.page)}onToogleManagment(){this.filterForm.reset(),this.containerOptions.dataLoading=!0,this.containerOptions.showSearch=!1,this.container.searchInput&&(this.container.searchInput.nativeElement.value=""),this.toogleManagment=!this.toogleManagment,this.toogleManagment||this.getGuardIncidents()}onOpenForm(t){this.toogleManagment?this.incidentTypeManagment.openForm():this.modalData={visible:!0,title:t?"Editar Incidente":"Nuevo Incidente",data:t,response:null}}onDelete(t){this.confirmationService.confirm({message:`\xBFEst\xE1s seguro de que quieres eliminar el incidente <span class="font-bold text-green-600">${t.subject}</span>?
      <br>
      <p class="mt-2"><span class="font-bold">Descripci\xF3n: </span> ${t.description}</p>
      <p class="font-bold text-red-600 mt-4">Esta acci\xF3n no se puede deshacer.</p>
`,header:"Confirmar eliminaci\xF3n de la incidencia",icon:"pi pi-info-circle",acceptButtonStyleClass:"p-button-danger",rejectButtonStyleClass:"p-button-secondary",acceptIcon:"pi pi-trash mr-2",acceptLabel:"S\xED",rejectLabel:"No",accept:()=>{this.guardIncidentService.deleteGuardIncident(t.id).subscribe({next:o=>{this.messageService.add({severity:"success",summary:"\xC9xito",detail:o.message}),this.reset(),this.getGuardIncidents()},error:o=>{let n=o.error.length>0?o.error:void 0;this.messageService.add(this.handleError(n))}})}})}onViewIncident(t){this.iv.visible=!0,this.iv.guardIncident=t,this.iv.ngOnChanges({socialEvent:{currentValue:t,previousValue:null,firstChange:!0,isFirstChange:()=>!0}})}onFilter(){this.getGuardIncidents(this.filterForm.get("subject")?.value||void 0,this.filterForm.get("date")?.value||void 0,this.filterForm.get("guard")?.value?Number(this.filterForm.get("guard")?.value):void 0,this.getSelectedType()?.id||void 0,this.getSelectedStatus()||void 0,0)}clearGuardOnFilter(){this.filterForm.patchValue({guard:"",guardToShow:""}),this.selectedGuard={}}onSearch(t){this.toogleManagment&&this.incidentTypeManagment.onSearch(t)}getGuardIncidents(t,o,n,m,C,v){this.galleryImages=[],this.guardIncidentService.findAllGuardIncidents(t,o,n,m,C,v).subscribe({next:y=>{this.containerOptions.dataLoading=!0;let N=y.data;this.guardIncidents=N.content,this.totalItems=N.totalItems,setTimeout(()=>{this.containerOptions.dataLoading=!1},300)},error:y=>{let N=y.error.length>0?y.error:void 0;this.messageService.add(this.handleError(N))}})}onPageChange(t){this.first=t.first,this.getGuardIncidents(this.filterForm.get("subject")?.value||void 0,this.filterForm.get("date")?.value||void 0,this.filterForm.get("guard")?.value?Number(this.filterForm.get("guard")?.value):void 0,this.filterForm.get("type")?.value||void 0,this.filterForm.get("status")?.value||void 0,t.page)}onShowDialogPanel(t,o){this.dialogContent=t,this.dialogVisible=!0,this.dialogTitle=o==="O"?"Observaci\xF3n":"Descripci\xF3n"}onDisplayGallery(t){this.displayGallery=!0;let o=t.map(n=>({itemImageSrc:n.fileUrl,thumbnailImageSrc:n.fileUrl,alt:n.id,title:n.id.toString()}));this.galleryImages=o}onHandleClose(){if(this.modalData.response){let t=this.modalData.response.id;if(t){let o={date:this.modalData.response.date,deletedFiles:this.modalData.response.deletedFiles,description:this.modalData.response.description,newFiles:this.modalData.response.files,guard:this.modalData.response.guard,observation:this.modalData.response.observation,status:this.modalData.response.status,subject:this.modalData.response.subject,type:this.modalData.response.type.id};this.guardIncidentService.updateGuardIncident(o,t).subscribe({next:n=>{this.messageService.add({severity:"success",summary:"\xC9xito",detail:n.message}),this.reset(),this.getGuardIncidents()},error:n=>{let m=n.error.length>0?n.error:void 0;this.messageService.add(this.handleError(m))}})}else{let o={date:this.modalData.response.date,description:this.modalData.response.description,files:this.modalData.response.files,guard:this.modalData.response.guard,subject:this.modalData.response.subject,type:this.modalData.response.type.id};this.guardIncidentService.createGuardIncident(o).subscribe({next:n=>{this.messageService.add({severity:"success",summary:"\xC9xito",detail:n.message}),this.reset(),this.getGuardIncidents()},error:n=>{let m=n.error.length>0?n.error:void 0;this.messageService.add(this.handleError(m))}})}}else this.reset()}reset(){this.modalData={visible:!1,title:"",data:null,response:null}}handleError(t="Error al realizar la acci\xF3n, intentelo de nuevo m\xE1s tarde"){return{severity:"error",detail:t,summary:"Error"}}getRowCellClass(t){return Le(t)}getRowClass(t){return Vt(t)}getTagClass(t){return t?Dt(t):""}getGuardActivityStatusSpanishTranslation(t){return t?Et(t):""}};l.\u0275fac=function(o){return new(o||l)},l.\u0275cmp=F({type:l,selectors:[["app-incidents"]],viewQuery:function(o,n){if(o&1&&(T(In,5),T(En,5),T(Vn,5),T(Dn,5)),o&2){let m;I(m=E())&&(n.container=m.first),I(m=E())&&(n.incidentTypeManagment=m.first),I(m=E())&&(n.iv=m.first),I(m=E())&&(n.search=m.first)}},standalone:!0,features:[ge,H],decls:17,vars:20,consts:[[1,"block","mt-2",3,"options","onSearch","onOpenForm"],["container",""],["customSearcher",""],["customActions","",1,"flex","gap-2"],["severity","help","icon","pi pi-cog",3,"label","rounded","raised","onClick"],[3,"toolbarHeight","options"],[3,"modalData","handleClose"],["styleClass","w-8","position","bottom",3,"visible","header","closable","draggable","visibleChange","onHide"],["ovp",""],["pTemplate","headless"],["containerClass","w-20rem md:w-30rem max-w-20rem md:max-w-30rem",3,"value","visible","responsiveOptions","numVisible","circular","fullScreen","showItemNavigators","showThumbnails","visibleChange"],["gallery",""],["pTemplate","item"],["iv",""],["icon","pi pi-angle-down","label","Abrir filtros","styleClass","bg-white hover:bg-gray-200",3,"rounded","raised","text","onClick"],["filterButton",""],["styleClass","bg-gray-700 w-11 lg:w-30rem",3,"showCloseIcon","dismissable"],["op",""],[3,"formGroup"],[1,"flex","flex-column","gap-1"],["styleClass","p-inputtext-sm w-full","placeholder","Fecha","formControlName","date","dateFormat","dd/mm/yy","appendTo","body"],[1,"flex","w-full","gap-1"],["appendTo","body","formControlName","type","placeholder","Seleccine un tipo","optionLabel","name","styleClass","w-full p-inputtext-sm",1,"w-full",3,"options","onClear"],["typeDropdown",""],["pTemplate","selectedItem"],["appendTo","body","formControlName","status","placeholder","Seleccine un tipo","optionLabel","name","styleClass","w-full p-inputtext-sm",1,"w-full",3,"options","onClear"],["statusDropdown",""],[1,"flex","gap-1"],["pInputText","","placeholder","Guardia","id","guardToShow","formControlName","guardToShow",1,"p-inputtext-sm",3,"readOnly"],["title","Limpiar guardia","type","button","pButton","","icon","pi pi-times",1,"p-button-sm",3,"click"],["pButton","","title","Seleccionar","type","button","icon","pi pi-arrow-right-arrow-left","label","Seleccionar",1,"p-button-rounded","p-button-sm","p-button-secondary","w-14rem",3,"click"],["btn",""],["type","text","pInputText","","placeholder","Asunto","formControlName","subject",1,"w-full","p-inputtext-sm"],[1,"flex","justify-content-between","mt-2"],["icon","pi pi-filter-slash","label","Limpiar","size","small",3,"outlined","onClick"],["icon","pi pi-filter","label","Filtrar","size","small",3,"outlined","onClick"],["styleClass","bg-gray-200 w-11 lg:w-6",3,"showCloseIcon","dismissable"],["op1",""],["pTemplate","content"],[1,"flex","align-items-center","gap-2"],["styleClass","uppercase text-xs",1,"text-xs",3,"value"],[1,"pi","pi-times",3,"click"],[1,"text-gray-500"],[1,"flex","gap-2"],["styleClass","uppercase",3,"value"],[3,"styleClass","value"],["pInputText","","placeholder","Buscar",1,"p-inputtext-sm","mb-2",3,"input"],["search",""],["class","flex justify-content-center"],[1,"flex","justify-content-center"],["styleClass","w-14rem h-14rem","strokeWidth","4","fill","var(--surface-ground)","animationDuration",".5s"],["styleClass","p-datatable-sm p-datatable-striped","selectionMode","single",3,"value","tableStyle","scrollable","scrollHeight","selection","selectionChange","onRowSelect"],["pTemplate","header"],["pTemplate","body"],["pTemplate","summary"],[3,"pSelectableRow"],["alt","Foto de perfil",1,"w-3rem","max-h-4rem","rounded-full",3,"src"],[3,"rows","first","totalRecords","currentPageReportTemplate","showJumpToPageDropdown","onPageChange"],[1,"text-lg","py-2"],["incidentTypeManagment",""],["styleClass","p-datatable-sm p-datatable-striped",3,"value","tableStyle","scrollable","scrollHeight"],[1,"w-1rem"],["severity","help","label","Mostrar","styleClass","w-full","size","small",3,"rounded","text","raised"],["tag",""],[1,"w-8rem"],[3,"value","styleClass"],["severity","info","label","Mostrar","icon","pi pi-external-link","styleClass","w-full","size","small",3,"rounded","text","raised"],["icon","pi pi-eye","severity","secondary","label","Ver","size","small",3,"rounded","raised","onClick"],["icon","pi pi-pencil","severity","warning","label","Editar","size","small",3,"rounded","raised","onClick"],["icon","pi pi-trash","severity","danger","label","Eliminar","size","small",3,"rounded","raised","onClick"],["severity","help","label","Mostrar","styleClass","w-full","size","small",3,"rounded","text","raised","click"],["severity","info","label","Mostrar","icon","pi pi-external-link","styleClass","w-full","size","small",3,"rounded","text","raised","click"],[3,"rows","showJumpToPageDropdown","currentPageReportTemplate","first","totalRecords","onPageChange"],[1,"text-lg","py-2","px-4"],[1,"bg-black-alpha-90","p-3","border-round","shadow-1"],[1,"text-teal-300","mb-2"],[1,"text-white"],[1,"flex","justify-content-end","mt-2"],["size","small","icon","pi pi-times","label","Cerrar","styleClass","ml-auto","severity","danger",3,"raised","rounded","onClick"],[3,"src"]],template:function(o,n){if(o&1){let m=x();r(0,"app-container",0,1),g("onSearch",function(v){return n.onSearch(v)})("onOpenForm",function(){return n.onOpenForm()}),f(2,Xn,30,13,"div",2),r(3,"div",3)(4,"p-button",4),g("onClick",function(){return n.onToogleManagment()}),a()(),f(5,Zn,1,0,"app-data-loader")(6,Yn,2,2,"app-incident-type-managment",5)(7,po,4,5),a(),r(8,"app-incident-form",6),g("handleClose",function(){return n.onHandleClose()}),a(),r(9,"p-dialog",7,8),g("visibleChange",function(v){return n.dialogVisible=v})("onHide",function(){return n.dialogVisible=!1}),f(11,co,7,4,"ng-template",9),a(),r(12,"p-galleria",10,11),g("visibleChange",function(v){return n.displayGallery=v})("visibleChange",function(){u(m);let v=P(13);return _(v._activeIndex=0)}),f(14,uo,1,4,"ng-template",12),a(),h(15,"app-incident-view",null,13)}o&2&&(p("options",n.containerOptions),s(2),b(2,n.toogleManagment?-1:2),s(2),p("label",n.toogleManagment?"Administrar incidentes":"Administrar tipos")("rounded",!0)("raised",!0),s(),b(5,n.containerOptions.dataLoading?5:-1),s(),b(6,n.toogleManagment?6:7),s(2),p("modalData",n.modalData),s(),p("visible",n.dialogVisible)("header",n.dialogTitle)("closable",!0)("draggable",!1),s(3),p("value",n.galleryImages)("visible",n.displayGallery)("responsiveOptions",n.responsiveOptions)("numVisible",7)("circular",!0)("fullScreen",!0)("showItemNavigators",!0)("showThumbnails",!1))},dependencies:[Gt,se,le,G,Re,L,ae,R,ti,kt,oi,be,A,j,Ge,He,Fe,K,Y,W,J,B,Q,Xt,$t,ri,Me,ke,ie,ee,te,oe,ne,Oe,Ne,Pe,ze,Ae,St,wt]});let i=l;return i})();export{Ba as IncidentsComponent};
