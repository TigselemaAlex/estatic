import{a as he}from"./chunk-WEF2K6LM.js";import"./chunk-4JPFA7UL.js";import"./chunk-RC3HNZO7.js";import"./chunk-VBOQVG3O.js";import"./chunk-MFZZJFXN.js";import"./chunk-PLS5QCJQ.js";import{b as fe}from"./chunk-DEGAUCA6.js";import{b as ae,c as se,h as me,l as de,m as ce,n as ue}from"./chunk-U446ZUSE.js";import{a as le,b as pe}from"./chunk-7XV6CRBL.js";import"./chunk-LFBU7IBC.js";import{b as re}from"./chunk-6OSMVD66.js";import"./chunk-IAKHD2KQ.js";import"./chunk-KTZAFNHT.js";import"./chunk-L2YMTAJ4.js";import"./chunk-SQDM7FYD.js";import"./chunk-MUUDK5FO.js";import"./chunk-GS33KFGJ.js";import{k as ee,l as te,m as ie,n as ne,x as oe}from"./chunk-OHCSBWXS.js";import"./chunk-APKN3PFA.js";import"./chunk-X6GEXHSG.js";import"./chunk-MX4UQD2B.js";import"./chunk-X5B2VV3T.js";import"./chunk-ZTWDMVRM.js";import"./chunk-P7FDEGEE.js";import"./chunk-XSSXK7EZ.js";import{a as Z}from"./chunk-PXO2TRVQ.js";import"./chunk-PWTX4GCB.js";import{e as A,h as Q,p as $,q}from"./chunk-HXGQMCX4.js";import{a as z}from"./chunk-TDXTCVPJ.js";import"./chunk-WTM76CTQ.js";import{d as X,e as Y}from"./chunk-AXYD25ST.js";import{e as G,i as J,k as K,n as U,o as W}from"./chunk-VBSZGXZN.js";import{$ as V,Bc as R,Db as x,Eb as w,Fb as E,Gb as N,Hb as c,Ib as b,Jb as k,Kc as T,Nc as L,Ob as O,S as I,Ta as l,Wa as M,Y as u,Yb as H,_b as j,ab as F,db as y,ea as g,fa as v,fb as m,kb as P,mb as B,nb as D,ob as n,pb as r,qb as C,ub as S,wb as d,xb as f}from"./chunk-HOTPW52P.js";var ge=(()=>{let o=class o{constructor(){this.END_POINT=z.API_URL+"/protected/social-event",this.http=u(L)}findAll(e,t=0){return this.http.get(this.END_POINT,{params:{from:e?.from?.getTime()??"",to:e?.to?.getTime()??"",title:e?.title??"",page:t}})}create(e){let t=new FormData;t.append("title",e.title),t.append("place",e.place),t.append("date",e.date.getTime().toString()),t.append("createdBy",e.createdBy.toString()),e.description&&t.append("description",e.description),e.image&&e.image.size>0&&t.append("image",e.image);let i=new T;return i.append("Content-Type","form-data"),this.http.post(this.END_POINT,t,{headers:i})}update(e,t){let i=new FormData;i.append("title",t.title),i.append("place",t.place),i.append("date",t.date.getTime().toString()),i.append("updatedBy",t.updatedBy.toString()),i.append("isImageUpdated",t.isImageUpdated.toString()),t.description&&i.append("description",t.description),t.image&&t.image.size>0&&i.append("image",t.image);let p=new T;return p.append("Content-Type","form-data"),this.http.put(this.END_POINT+"/"+e,i,{headers:p})}delete(e){return this.http.delete(this.END_POINT+"/"+e)}};o.\u0275fac=function(t){return new(t||o)},o.\u0275prov=I({token:o,factory:o.\u0275fac,providedIn:"root"});let a=o;return a})();var _e=["sev"],Ce=["container"],Se=(a,o)=>o.id;function ye(a,o){if(a&1){let s=S();n(0,"div",20)(1,"div",21)(2,"div",22),C(3,"p-image",23),n(4,"span",24),c(5),r()(),n(6,"div",25)(7,"p",26),c(8," Lugar: "),n(9,"span",27),c(10),r()(),n(11,"p",26),c(12," Fecha & Hora: "),n(13,"span",28),c(14),H(15,"date"),r()()(),n(16,"div",29)(17,"p-button",30),d("onClick",function(){let i=g(s).$implicit,p=f(3);return v(p.openView(i))}),r(),n(18,"div",31)(19,"p-button",32),d("onClick",function(){let i=g(s).$implicit,p=f(3);return v(p.openForm(i))}),r(),n(20,"p-button",33),d("onClick",function(t){let p=g(s).$implicit,h=f(3);return v(h.onDelete(p,t))}),r()()()()()}if(a&2){let s=o.$implicit;l(3),m("src",s.imageUrl||"assets/images/No_image_available.svg")("preview",!!s.imageUrl),l(2),k(" ",s.title," "),l(5),b(s.place),l(4),b(j(15,11,s.date,"dd/MM/yyyy HH:mm")),l(3),m("rounded",!0)("raised",!0),l(2),m("rounded",!0)("raised",!0),l(),m("rounded",!0)("raised",!0)}}function xe(a,o){if(a&1&&(n(0,"div",19),B(1,ye,21,14,"div",34,Se),r()),a&2){let s=f(2);l(),D(s.socialEvents)}}function we(a,o){if(a&1){let s=S();n(0,"div",14)(1,"p-paginator",15),d("onPageChange",function(t){g(s);let i=f();return v(i.onPageChange(t))}),r()(),n(2,"p-dataView",16,17),y(4,xe,3,0,"ng-template",18),r()}if(a&2){let s=f();l(),m("rows",s.rows)("first",s.first)("currentPageReportTemplate","{currentPage} de {totalPages} p\xE1ginas ({totalRecords} registros)")("showJumpToPageDropdown",!0)("totalRecords",s.totalItems),l(),m("value",s.socialEvents)}}function Ee(a,o){a&1&&(n(0,"div",35)(1,"p",36),c(2,"No hay datos para mostrar"),r()())}var mt=(()=>{let o=class o extends Z{constructor(){super(),this.first=0,this.rows=10,this.totalItems=0,this.from=null,this.to=null,this.containerOptions={showNewButton:!0,showSearch:!1,dataLoading:!0},this.toolbarHeight=0,this.config=u(K),this.socialEventService=u(ge),this.messageService=u(J),this.confirmationService=u(G),this.cdr=u(M),this.socialEvents=[],this.modalData={visible:!1,title:"",data:null,response:null}}ngOnInit(){this.config.setTranslation(he),this.getSocialEvents()}getSocialEvents(e=0,t){this.socialEventService.findAll(t,e).subscribe({next:this.handleFindAllNext.bind(this)})}handleFindAllNext(e){this.containerOptions.dataLoading=!0;let t=e.data;this.socialEvents=t.content,this.totalItems=t.totalItems,setTimeout(()=>{this.containerOptions.dataLoading=!1},300)}openForm(e){this.modalData={visible:!0,title:e?"Editar evento social":"Nuevo evento social",data:e,response:null}}onSearch(e=""){if(this.from&&this.to){if(this.from>this.to){this.messageService.add({severity:"error",summary:"Error",detail:'La fecha de "Desde" no puede ser mayor a la fecha de "Hasta"'});return}this.getSocialEvents(0,{from:this.from,to:this.to,title:e})}else this.from&&!this.to?this.getSocialEvents(0,{from:this.from,title:e}):!this.from&&this.to?this.getSocialEvents(0,{to:this.to,title:e}):this.getSocialEvents(0,{title:e})}onPageChange(e){this.first=e.first,this.getSocialEvents(e.page)}onDelete(e,t){this.confirmationService.confirm({target:t.target,message:`\xBFEst\xE1s seguro de que quieres eliminar el evento social <span class="font-bold text-green-600">${e.title}</span>?`,header:"Confirmar eliminaci\xF3n del evento social",icon:"pi pi-info-circle",acceptButtonStyleClass:"p-button-danger",rejectButtonStyleClass:"p-button-secondary",acceptIcon:"pi pi-trash mr-2",acceptLabel:"S\xED",rejectLabel:"No",accept:()=>{this.socialEventService.delete(e.id).subscribe({next:i=>{this.messageService.add({severity:"success",summary:"\xC9xito",detail:"Evento social eliminado correctamente"}),this.getSocialEvents()},error:i=>{this.messageService.add({severity:"error",summary:"Error",detail:"Error al eliminar el evento social"})}})}})}onHandleClose(){if(this.modalData.response){let e=this.modalData.response.id;if(e){let t={title:this.modalData.response.title,description:this.modalData.response.description,date:this.modalData.response.date,place:this.modalData.response.place,image:this.modalData.response.image,isImageUpdated:this.modalData.response.isImageUpdated,updatedBy:this.modalData.response.createdBy};this.socialEventService.update(e,t).subscribe({next:i=>{this.messageService.add({severity:"success",summary:"\xC9xito",detail:"Evento social actualizado correctamente"}),this.reset(),this.getSocialEvents()},error:i=>{this.messageService.add({severity:"error",summary:"Error",detail:"Error al actualizar el evento social"}),this.reset()}})}else this.socialEventService.create(this.modalData.response).subscribe({next:t=>{this.messageService.add({severity:"success",summary:"\xC9xito",detail:"Evento social creado correctamente"}),this.reset(),this.getSocialEvents()},error:t=>{this.messageService.add({severity:"error",summary:"Error",detail:"Error al crear el evento social"}),this.reset()}})}else this.reset()}openView(e){this.socialEventView.socialEvent=e,this.socialEventView.visible=!0,this.socialEventView.ngOnChanges({socialEvent:{previousValue:null,currentValue:e,firstChange:!0,isFirstChange:()=>!0}})}reset(){this.modalData={visible:!1,title:"",data:null,response:null}}ngAfterViewInit(){this.toolbarHeight=this.containerComponent.toolbar.getBlockableElement().clientHeight,this.cdr.detectChanges()}};o.\u0275fac=function(t){return new(t||o)},o.\u0275cmp=V({type:o,selectors:[["app-social-events"]],viewQuery:function(t,i){if(t&1&&(x(_e,5),x(Ce,5)),t&2){let p;w(p=E())&&(i.socialEventView=p.first),w(p=E())&&(i.containerComponent=p.first)}},standalone:!0,features:[F,O],decls:22,vars:11,consts:[[3,"options","onOpenForm"],["container",""],["customSearcher","",1,"flex","gap-2"],[1,"flex","gap-1","align-items-center"],["for","from",1,"text-teal-50"],["id","from","dateFormat","dd/mm/yy","appendTo","body","styleClass","p-inputtext-sm",3,"ngModel","showTime","showButtonBar","ngModelChange"],["for","to",1,"text-teal-50"],["id","to","dateFormat","dd/mm/yy","appendTo","body","styleClass","p-inputtext-sm",3,"ngModel","showTime","showButtonBar","ngModelChange"],["for","title",1,"text-teal-50"],["pInputText","","type","text","id","title","placeholder","T\xEDtulo del evento",1,"p-inputtext-sm"],["title",""],["icon","pi pi-search","label","Buscar","severity","help",3,"rounded","raised","onClick"],[3,"modalData","handleClose"],["sev",""],[1,"flex","justify-content-center","mb-2"],[1,"shadow-1","w-full",3,"rows","first","currentPageReportTemplate","showJumpToPageDropdown","totalRecords","onPageChange"],["layout","grid","styleClass","w-full",3,"value"],["dv",""],["pTemplate","grid"],[1,"grid","grid-nogutter","bg-teal-50"],[1,"col-12","sm:col-6","xl:col-4","p-2"],[1,"shadow-2","surface-border","border-round","bg-white","w-full","h-full","flex","flex-column","gap-4","bg-white","p-4"],[1,"flex","flex-wrap","flex-column","align-items-center","justify-content-center","gap-4"],["imageClass","w-full h-15rem border-round shadow-2","styleClass","w-full h-15rem",3,"src","preview"],[1,"font-bold","text-2xl","uppercase","text-teal-800","text-center"],[1,"flex","flex-column","justify-content-start","align-items-start","gap-2"],[1,"text-sm","font-bold"],[1,"text-teal-600","font-normal"],[1,"text-indigo-600","font-normal"],[1,"flex","justify-content-between","align-items-center","gap-2","mt-auto"],["icon","pi pi-eye","severity","secondary","label","Ver","size","small",1,"p-button-rounded","p-button-raised","text-sm",3,"rounded","raised","onClick"],[1,"flex","gap-2"],["icon","pi pi-pencil","label","Editar","severity","warning","size","small",1,"p-button-rounded","p-button-raised",3,"rounded","raised","onClick"],["icon","pi pi-trash","severity","danger","label","Eliminar","size","small",1,"p-button-rounded","p-button-raised",3,"rounded","raised","onClick"],["class","col-12 sm:col-6 xl:col-4 p-2"],[1,"flex","justify-content-center","w-full"],[1,"text-lg","py-2","px-4"]],template:function(t,i){if(t&1){let p=S();n(0,"app-container",0,1),d("onOpenForm",function(){return i.openForm()}),n(2,"div",2)(3,"span",3)(4,"label",4),c(5,"Desde:"),r(),n(6,"p-calendar",5),d("ngModelChange",function(_){return i.from=_}),r()(),n(7,"span",3)(8,"label",6),c(9,"Hasta:"),r(),n(10,"p-calendar",7),d("ngModelChange",function(_){return i.to=_}),r()(),n(11,"span",3)(12,"label",8),c(13,"T\xEDtulo:"),r(),C(14,"input",9,10),r(),n(16,"p-button",11),d("onClick",function(){g(p);let _=N(15);return v(i.onSearch(_.value))}),r()(),y(17,we,5,6)(18,Ee,3,0),r(),n(19,"app-social-event-form",12),d("handleClose",function(){return i.onHandleClose()}),r(),C(20,"app-social-event-view",null,13)}t&2&&(m("options",i.containerOptions),l(6),m("ngModel",i.from)("showTime",!0)("showButtonBar",!0),l(4),m("ngModel",i.to)("showTime",!0)("showButtonBar",!0),l(6),m("rounded",!0)("raised",!0),l(),P(17,i.socialEvents.length>0?17:18),l(2),m("modalData",i.modalData))},dependencies:[Y,X,U,fe,R,q,$,ne,ie,A,Q,re,W,oe,ce,te,ee,me,se,ae,pe,le,de,ue]});let a=o;return a})();export{mt as SocialEventsComponent};
