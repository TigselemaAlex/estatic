import{a as ae}from"./chunk-X7SG3D25.js";import{b as Y}from"./chunk-B2W5NOZS.js";import{b as ne}from"./chunk-DEGAUCA6.js";import{a as te,b as ie}from"./chunk-LFBU7IBC.js";import{b as re}from"./chunk-6OSMVD66.js";import"./chunk-KTZAFNHT.js";import{e as K,f as Q}from"./chunk-SQDM7FYD.js";import{n as Z,q as ee,x as D}from"./chunk-OHCSBWXS.js";import"./chunk-APKN3PFA.js";import"./chunk-X6GEXHSG.js";import{a as U,b as W}from"./chunk-MX4UQD2B.js";import"./chunk-X5B2VV3T.js";import"./chunk-ZTWDMVRM.js";import"./chunk-XSSXK7EZ.js";import{a as X}from"./chunk-PXO2TRVQ.js";import"./chunk-PWTX4GCB.js";import{b as A,c as b,e as N,f as H,i as O,j as q,k as B,l as z,n as G,o as j,p as $,q as L}from"./chunk-HXGQMCX4.js";import"./chunk-TDXTCVPJ.js";import"./chunk-WTM76CTQ.js";import{d as F,e as S}from"./chunk-AXYD25ST.js";import{i as R,n as x,o as J}from"./chunk-VBSZGXZN.js";import{$ as T,Hb as d,Ib as P,Ob as k,Pb as I,Ta as p,Y as y,Za as w,ab as V,da as M,db as f,ea as _,fa as h,fb as s,kb as E,ob as n,pb as a,qb as C,ub as v,wb as u,xb as c}from"./chunk-HOTPW52P.js";function me(e,t){if(e&1&&C(0,"app-error-input",6),e&2){let l=c();s("message",l.getErrorMessage("type",l.parkingTypeForm))}}function de(e,t){if(e&1&&C(0,"app-error-input",6),e&2){let l=c();s("message",l.getErrorMessage("description",l.parkingTypeForm))}}function ue(e,t){if(e&1){let l=v();n(0,"p-button",9),u("onClick",function(){_(l);let o=c();return h(o.handleAccept())}),a(),n(1,"p-button",10),u("onClick",function(){_(l);let o=c();return h(o.handleClose.emit())}),a()}e&2&&(s("raised",!0)("rounded",!0),p(),s("raised",!0)("rounded",!0))}var oe=(()=>{let t=class t{constructor(){this.modalData={visible:!1,title:"",data:null,response:null},this.handleClose=new w,this.fb=y(z),this.parkingTypeForm=this.fb.group({id:[""],type:[{value:"",disabled:!0}],description:["",b.required],price:["",[b.required,b.min(.01)]]}),this.getErrorMessage=W}handleAccept(){this.parkingTypeForm.valid?(this.modalData.response=this.parkingTypeForm.value,this.handleClose.emit()):Object.values(this.parkingTypeForm.controls).forEach(i=>{i.invalid&&(i.markAsDirty(),i.updateValueAndValidity({onlySelf:!0}))})}ngOnChanges(i){i.modalData&&(this.parkingTypeForm.reset(),this.parkingTypeForm.patchValue(this.modalData.data))}};t.\u0275fac=function(o){return new(o||t)},t.\u0275cmp=T({type:t,selectors:[["app-parking-type-form"]],inputs:{modalData:"modalData"},outputs:{handleClose:"handleClose"},standalone:!0,features:[M,k],decls:15,vars:9,consts:[["styleClass","w-10 md:w-25rem",3,"header","visible","modal","draggable","resizable","visibleChange","onHide"],[1,"pt-4","grid","row-gap-3",3,"formGroup"],[1,"col-12"],[1,"p-float-label"],["pInputText","","id","type","formControlName","type","type","text","autocomplete","off",1,"w-full",3,"disabled"],["for","type"],[3,"message"],["formControlName","description","id","float-input","rows","5","pInputTextarea","",1,"w-full"],["pTemplate","footer"],["label","Aceptar","severity","success",3,"raised","rounded","onClick"],["label","Cancelar","severity","danger",3,"raised","rounded","onClick"]],template:function(o,r){if(o&1&&(n(0,"p-dialog",0),u("visibleChange",function(g){return r.modalData.visible=g})("onHide",function(){return r.handleClose.emit()}),n(1,"form",1)(2,"div",2)(3,"span",3),C(4,"input",4),n(5,"label",5),d(6,"Tipo"),a()(),f(7,me,1,1,"app-error-input",6),a(),n(8,"div",2)(9,"span",3),C(10,"textarea",7),n(11,"label",5),d(12,"Descripci\xF3n"),a()(),f(13,de,1,1,"app-error-input",6),a()(),f(14,ue,2,4,"ng-template",8),a()),o&2){let m,g;s("header",r.modalData.title)("visible",r.modalData.visible)("modal",!0)("draggable",!1)("resizable",!1),p(),s("formGroup",r.parkingTypeForm),p(3),s("disabled",!0),p(3),E(7,(m=r.parkingTypeForm.get("type"))!=null&&m.invalid&&((m=r.parkingTypeForm.get("type"))!=null&&m.dirty)?7:-1),p(6),E(13,(g=r.parkingTypeForm.get("description"))!=null&&g.invalid&&((g=r.parkingTypeForm.get("description"))!=null&&g.dirty)?13:-1)}},dependencies:[S,F,x,Q,K,U,G,O,A,N,H,L,$,Y,Z,re,j,q,B,J,D,ie,te]});let e=t;return e})();function ce(e,t){e&1&&(n(0,"tr")(1,"th"),d(2,"Tipo"),a(),n(3,"th"),d(4,"Descripci\xF3n"),a(),n(5,"th"),d(6,"Acciones"),a()())}function ge(e,t){if(e&1){let l=v();n(0,"tr")(1,"td"),d(2),a(),n(3,"td"),d(4),a(),n(5,"td")(6,"div",5)(7,"p-button",6),u("onClick",function(){let r=_(l).$implicit,m=c();return h(m.openForm(r))}),a()()()()}if(e&2){let l=t.$implicit;p(2),P(l.type),p(2),P(l.description),p(3),s("rounded",!0)("raised",!0)}}var fe=()=>({"min-width":"50rem"}),Ke=(()=>{let t=class t extends X{constructor(){super(),this.modalData={visible:!1,title:"",data:null,response:null},this.dataLoading=!0,this.parkingTypes=[],this.parkingService=y(ae),this.messageService=y(R)}ngOnInit(){super.ngOnInit(),this.getAllParkingTypes()}getAllParkingTypes(){this.parkingService.findAllTypes().subscribe({next:i=>{this.parkingTypes=i.data},error:i=>{this.messageService.add({severity:"error",summary:"Error",detail:"Ha ocurrido un error al obtener los tipos de parqueo. Por favor, intenta m\xE1s tarde."})}})}openForm(i){this.modalData={visible:!0,title:"Editar tipo de parqueadero",data:i,response:null}}onHandleClose(){if(this.modalData.response){let i=this.modalData.response.id,o={price:this.modalData.response.price,description:this.modalData.response.description};this.parkingService.updateType(i,o).subscribe({next:r=>{this.messageService.add({severity:"success",summary:"\xC9xito",detail:"Tipo de parqueadero actualizado correctamente."}),this.reset(),this.getAllParkingTypes()},error:r=>{this.messageService.add({severity:"error",summary:"Error",detail:"Ha ocurrido un error al actualizar el tipo de parqueadero. Por favor, intenta m\xE1s tarde."})}})}else this.reset()}reset(){this.modalData={visible:!1,title:"",data:null,response:null}}};t.\u0275fac=function(o){return new(o||t)},t.\u0275cmp=T({type:t,selectors:[["app-type-parking"]],standalone:!0,features:[V,k],decls:5,vars:5,consts:[[1,"flex","flex-column","gap-3","align-items-center","h-full"],["styleClass","p-datatable-sm p-datatable-striped",3,"value","tableStyle","scrollable"],["pTemplate","header"],["pTemplate","body"],[3,"modalData","handleClose"],[1,"flex","gap-1"],["icon","pi pi-pencil","severity","warning","size","small",3,"rounded","raised","onClick"]],template:function(o,r){o&1&&(n(0,"section",0)(1,"p-table",1),f(2,ce,7,0,"ng-template",2)(3,ge,8,4,"ng-template",3),a()(),n(4,"app-parking-type-form",4),u("handleClose",function(){return r.onHandleClose()}),a()),o&2&&(p(),s("value",r.parkingTypes)("tableStyle",I(4,fe))("scrollable",!0),p(3),s("modalData",r.modalData))},dependencies:[D,ee,x,S,F,ne,oe]});let e=t;return e})();export{Ke as TypeParkingComponent};
