import{a as ve}from"./chunk-TTGOBAEU.js";import{a as ce,b as fe}from"./chunk-VBOQVG3O.js";import{a as de,b as ue}from"./chunk-DEGAUCA6.js";import{j as pe}from"./chunk-Y6YU6P5I.js";import"./chunk-YGKFOOJ6.js";import"./chunk-7XV6CRBL.js";import{a as se,b as me}from"./chunk-LFBU7IBC.js";import"./chunk-6OSMVD66.js";import"./chunk-IAKHD2KQ.js";import"./chunk-KTZAFNHT.js";import"./chunk-L2YMTAJ4.js";import{e as ie,f as re}from"./chunk-SQDM7FYD.js";import"./chunk-MUUDK5FO.js";import"./chunk-GS33KFGJ.js";import{q as ae,x as le}from"./chunk-OHCSBWXS.js";import"./chunk-APKN3PFA.js";import"./chunk-X6GEXHSG.js";import{a as ne,b as oe}from"./chunk-MX4UQD2B.js";import"./chunk-X5B2VV3T.js";import"./chunk-ZTWDMVRM.js";import"./chunk-P7FDEGEE.js";import"./chunk-XSSXK7EZ.js";import"./chunk-PWTX4GCB.js";import{b as z,c as v,e as j,f as Q,i as G,j as U,k as J,m as W,o as K,p as X,q as Y}from"./chunk-HXGQMCX4.js";import"./chunk-TDXTCVPJ.js";import"./chunk-WTM76CTQ.js";import{c as te,d as M,e as N}from"./chunk-AXYD25ST.js";import{e as Z,i as ee,n as I}from"./chunk-VBSZGXZN.js";import{$ as F,Ab as $,Db as V,Eb as O,Fb as B,Hb as m,Ib as x,Ka as R,Ob as k,Pb as H,Ta as s,Wa as A,Y as C,Za as q,da as L,db as f,ea as b,fa as y,fb as p,kb as _,ob as r,pb as n,qb as d,ub as S,wb as g,xb as u}from"./chunk-HOTPW52P.js";function be(t,l){if(t&1&&d(0,"app-error-input",6),t&2){let i=u();p("message",i.getErrorMessage("name",i.form))}}function ye(t,l){if(t&1&&d(0,"app-error-input",22),t&2){let i=u();p("message",i.getErrorMessage("ruc",i.form))}}function xe(t,l){if(t&1&&d(0,"app-error-input",22),t&2){let i=u();p("message",i.getErrorMessage("phone",i.form))}}function Se(t,l){if(t&1&&d(0,"app-error-input",6),t&2){let i=u();p("message",i.getErrorMessage("email",i.form))}}function Ee(t,l){if(t&1&&d(0,"app-error-input",6),t&2){let i=u();p("message",i.getErrorMessage("address",i.form))}}function we(t,l){if(t&1&&d(0,"app-error-input",6),t&2){let i=u();p("message",i.getErrorMessage("website",i.form))}}function Te(t,l){if(t&1&&d(0,"app-error-input",6),t&2){let i=u();p("message",i.getErrorMessage("description",i.form))}}function Pe(t,l){if(t&1){let i=S();r(0,"p-button",23),g("onClick",function(){b(i);let e=u();return y(e.handleAccept())}),n(),r(1,"p-button",24),g("onClick",function(){b(i);let e=u();return e.modalData.response=null,y(e.handleClose.emit())}),n()}t&2&&(p("raised",!0)("rounded",!0),s(),p("raised",!0)("rounded",!0))}var _e=(()=>{let l=class l{constructor(){this.fb=C(W),this.getErrorMessage=oe,this.modalData={title:"",visible:!1,data:null,response:null},this.handleClose=new q,this.form=this.fb.group({id:[""],name:["",v.required],description:["",v.maxLength(255)],address:["",[v.required,v.maxLength(255)]],phone:["",[v.required,v.pattern("^[0-9]*$")]],email:["",[v.email,v.required]],website:[""],ruc:["",[v.required,v.maxLength(13),v.minLength(10),v.pattern(/^[0-9]*$/)]]})}ngOnChanges(a){a.modalData&&(this.form.reset(),this.modalData.data&&this.form.patchValue(this.modalData.data))}handleAccept(){this.form.valid?(this.modalData.response=this.form.value,this.handleClose.emit()):Object.values(this.form.controls).forEach(a=>{a.invalid&&(a.markAsDirty(),a.updateValueAndValidity({onlySelf:!0}))})}};l.\u0275fac=function(e){return new(e||l)},l.\u0275cmp=F({type:l,selectors:[["app-provider-form"]],inputs:{modalData:"modalData"},outputs:{handleClose:"handleClose"},standalone:!0,features:[L,k],decls:45,vars:17,consts:[["id","dialog","styleClass","w-10 md:w-6 lg:w-6",3,"header","visible","modal","draggable","resizable","visibleChange","onHide"],[1,"pt-4","grid","row-gap-3","h-full",3,"formGroup"],[1,"col-12","lg:col-6"],[1,"p-float-label"],["pInputText","","formControlName","name","id","name","type","text",1,"w-full"],["for","name"],[3,"message"],["id","dni","mask","9999999999?999","formControlName","ruc","slotChar","","styleClass","w-full",3,"autoClear","unmask"],["for","ruc"],["class","-mt-4",3,"message"],["id","phone","mask","9999999999","formControlName","phone","styleClass","w-full",3,"autoClear"],["for","phone"],["pInputText","","formControlName","email","id","email","type","text",1,"w-full"],["for","email"],[1,"col-12"],["pInputText","","formControlName","address","id","address","type","text",1,"w-full"],["for","address"],["pInputText","","formControlName","website","id","website","type","text",1,"w-full"],["for","website"],["pInputTextarea","","formControlName","description","id","description",1,"w-full",3,"rows"],["for","description"],["pTemplate","footer"],[1,"-mt-4",3,"message"],["label","Aceptar","severity","success",3,"raised","rounded","onClick"],["label","Cancelar","severity","danger",3,"raised","rounded","onClick"]],template:function(e,o){if(e&1&&(r(0,"p-dialog",0),g("visibleChange",function(h){return o.modalData.visible=h})("onHide",function(){return o.modalData.response=null,o.handleClose.emit()}),r(1,"form",1)(2,"div",2)(3,"span",3),d(4,"input",4),r(5,"label",5),m(6,"Nombre"),n()(),f(7,be,1,1,"app-error-input",6),n(),r(8,"div",2)(9,"span",3),d(10,"p-inputMask",7),r(11,"label",8),m(12,"R.U.C."),n()(),f(13,ye,1,1,"app-error-input",9),n(),r(14,"div",2)(15,"span",3),d(16,"p-inputMask",10),r(17,"label",11),m(18,"Tel\xE9fono"),n()(),f(19,xe,1,1,"app-error-input",9),n(),r(20,"div",2)(21,"span",3),d(22,"input",12),r(23,"label",13),m(24,"Correo"),n()(),f(25,Se,1,1,"app-error-input",6),n(),r(26,"div",14)(27,"span",3),d(28,"input",15),r(29,"label",16),m(30,"Direcci\xF3n"),n()(),f(31,Ee,1,1,"app-error-input",6),n(),r(32,"div",14)(33,"span",3),d(34,"input",17),r(35,"label",18),m(36,"Sitio web"),n()(),f(37,we,1,1,"app-error-input",6),n(),r(38,"div",14)(39,"span",3),d(40,"textarea",19),r(41,"label",20),m(42,"Descripci\xF3n"),n()(),f(43,Te,1,1,"app-error-input",6),n()(),f(44,Pe,2,4,"ng-template",21),n()),e&2){let c,h,E,w,T,P,D;p("header",o.modalData.title)("visible",o.modalData.visible)("modal",!0)("draggable",!1)("resizable",!1),s(),p("formGroup",o.form),s(6),_(7,(c=o.form.get("name"))!=null&&c.dirty&&((c=o.form.get("name"))!=null&&c.invalid)?7:-1),s(3),p("autoClear",!1)("unmask",!0),s(3),_(13,(h=o.form.get("ruc"))!=null&&h.invalid&&((h=o.form.get("ruc"))!=null&&h.dirty)?13:-1),s(3),p("autoClear",!1),s(3),_(19,(E=o.form.get("phone"))!=null&&E.invalid&&((E=o.form.get("phone"))!=null&&E.dirty)?19:-1),s(6),_(25,(w=o.form.get("email"))!=null&&w.dirty&&((w=o.form.get("email"))!=null&&w.invalid)?25:-1),s(6),_(31,(T=o.form.get("address"))!=null&&T.dirty&&((T=o.form.get("address"))!=null&&T.invalid)?31:-1),s(6),_(37,(P=o.form.get("website"))!=null&&P.dirty&&((P=o.form.get("website"))!=null&&P.invalid)?37:-1),s(3),p("rows",5),s(3),_(43,(D=o.form.get("description"))!=null&&D.dirty&&((D=o.form.get("description"))!=null&&D.invalid)?43:-1)}},dependencies:[re,ie,I,K,G,z,j,Q,U,J,N,M,me,se,Y,X,ne,fe,ce]});let t=l;return t})();var De=["container"],Fe=["table"];function ke(t,l){t&1&&(r(0,"tr")(1,"th"),m(2,"R.U.C."),n(),r(3,"th"),m(4,"Nombre"),n(),r(5,"th"),m(6,"Descripci\xF3n"),n(),r(7,"th"),m(8,"Direcci\xF3n"),n(),r(9,"th"),m(10,"Correo"),n(),r(11,"th"),m(12,"Tel\xE9fono"),n(),r(13,"th"),m(14,"P\xE1gina Web"),n(),r(15,"th"),m(16,"Activo"),n(),r(17,"th",7),m(18,"Acciones"),n()())}function Ie(t,l){if(t&1&&d(0,"a",13),t&2){let i=u().$implicit;$("href",i.website,R),p("text","")}}function Me(t,l){t&1&&m(0," Sin p\xE1gina web ")}function Ne(t,l){if(t&1){let i=S();r(0,"p-button",14),g("onClick",function(){b(i);let e=u().$implicit,o=u();return y(o.onDeleteProvider(e))}),n()}t&2&&p("rounded",!0)("raised",!0)}function Ve(t,l){if(t&1){let i=S();r(0,"p-button",15),g("onClick",function(){b(i);let e=u().$implicit,o=u();return y(o.onReactivateProvider(e))}),n()}t&2&&p("rounded",!0)("raised",!0)}function Oe(t,l){if(t&1){let i=S();r(0,"tr")(1,"td"),m(2),n(),r(3,"td"),m(4),n(),r(5,"td"),m(6),n(),r(7,"td"),m(8),n(),r(9,"td"),m(10),n(),r(11,"td"),m(12),n(),r(13,"td"),f(14,Ie,1,2,"a",8)(15,Me,1,0),n(),r(16,"td"),d(17,"p-chip",9),n(),r(18,"td")(19,"div",10)(20,"p-button",11),g("onClick",function(){let o=b(i).$implicit,c=u();return y(c.onOpenForm(o))}),n(),f(21,Ne,1,2,"p-button",12)(22,Ve,1,2),n()()()}if(t&2){let i=l.$implicit;s(2),x(i.ruc),s(2),x(i.name),s(2),x(i.description),s(2),x(i.address),s(2),x(i.email),s(2),x(i.phone),s(2),_(14,i.website?14:15),s(3),p("label",i.active?"Si":"No")("styleClass",i.active?"bg-blue-100 text-blue-600 text-sm shadow-3":"bg-red-100 text-red-600 text-sm shadow-3"),s(3),p("rounded",!0)("raised",!0),s(),_(21,i.active?21:22)}}var Be=()=>({"min-width":"50rem"}),He=()=>["name","ruc"],ft=(()=>{let l=class l{constructor(){this.messageService=C(ee),this.confirmationService=C(Z),this.cdr=C(A),this.providerService=C(ve),this.providers=[],this.modalData={title:"",visible:!1,data:null,response:null},this.toolbarHeight=0,this.containerOptions={dataLoading:!0,showNewButton:!0,showSearch:!0}}ngOnInit(){this.getProviders()}ngAfterViewInit(){this.toolbarHeight=this.container.toolbar.getBlockableElement().clientHeight,this.cdr.detectChanges()}getProviders(){this.containerOptions.dataLoading=!0,this.providerService.findAll().subscribe({next:a=>{this.providers=a.data,setTimeout(()=>{this.containerOptions.dataLoading=!1},300)},error:()=>{this.messageService.add({severity:"error",summary:"Error",detail:"Ha ocurrido un error al cargar los proveedores"})}})}onOpenForm(a){this.modalData={title:a?"Editar proveedor":"Nuevo proveedor",visible:!0,data:a,response:null}}onSearch(a){this.table.filterGlobal(a,"contains")}onReactivateProvider(a){this.confirmationService.confirm({message:`\xBFEst\xE1 seguro que desea habilitar al proveedor
                <span class="font-bold"> ${a.name}</span>
                ?`,header:"Confirmar habilitaci\xF3n",icon:"pi pi-info-circle",acceptButtonStyleClass:"p-button-success ",rejectButtonStyleClass:"p-button-secondary",acceptIcon:"pi pi-tick mr-2",acceptLabel:"S\xED",rejectLabel:"No",accept:()=>{this.providerService.activate(a.id).subscribe({next:e=>{this.messageService.add({severity:"success",summary:"Proveedor habilitado",detail:e.message}),this.getProviders()},error:e=>{e.error?e.status===500?this.messageService.add({severity:"error",summary:"Error",detail:e.error}):this.messageService.add({severity:"error",summary:"Error",detail:e.error.message}):this.messageService.add({severity:"error",summary:"Error",detail:"Error al habilitar al proveedor"})}})}})}onDeleteProvider(a){this.confirmationService.confirm({message:`\xBFEst\xE1 seguro que desea eliminar al proveedor
                <span class="font-bold"> ${a.name}</span>
                ?`,header:"Confirmar eliminaci\xF3n",icon:"pi pi-info-circle",acceptButtonStyleClass:"p-button-danger",rejectButtonStyleClass:"p-button-secondary",acceptIcon:"pi pi-trash mr-2",acceptLabel:"S\xED",rejectLabel:"No",accept:()=>{this.providerService.delete(a.id).subscribe({next:e=>{this.messageService.add({severity:"success",summary:"Proveedor eliminado",detail:e.message}),this.getProviders()},error:e=>{e.error?e.status===500?this.messageService.add({severity:"error",summary:"Error",detail:e.error}):this.messageService.add({severity:"error",summary:"Error",detail:e.error.message}):this.messageService.add({severity:"error",summary:"Error",detail:"Error al eliminar al proveedor"})}})}})}onHandleCose(){if(this.modalData.response){let a=this.modalData.response.id;a?this.providerService.update(a,this.modalData.response).subscribe({next:e=>{this.getProviders(),this.messageService.add({severity:"success",summary:"\xC9xito",detail:e.message}),this.reset()},error:e=>{e.error?e.status===500?this.messageService.add({severity:"error",summary:"Error",detail:e.error}):this.messageService.add({severity:"error",summary:"Error",detail:e.error.message}):this.messageService.add({severity:"error",summary:"Error",detail:"Error al actualizar el proveedor"})}}):this.providerService.create(this.modalData.response).subscribe({next:e=>{this.getProviders(),this.messageService.add({severity:"success",summary:"\xC9xito",detail:e.message}),this.reset()},error:e=>{e.error?e.status===500?this.messageService.add({severity:"error",summary:"Error",detail:e.error}):this.messageService.add({severity:"error",summary:"Error",detail:e.error.message}):this.messageService.add({severity:"error",summary:"Error",detail:"Error al crear el proveedor"})}})}else this.reset()}reset(){this.modalData={title:"",visible:!1,data:null,response:null}}};l.\u0275fac=function(e){return new(e||l)},l.\u0275cmp=F({type:l,selectors:[["app-providers"]],viewQuery:function(e,o){if(e&1&&(V(De,5),V(Fe,5)),e&2){let c;O(c=B())&&(o.container=c.first),O(c=B())&&(o.table=c.first)}},standalone:!0,features:[k],decls:7,vars:13,consts:[[1,"block","mt-2",3,"options","onSearch","onOpenForm"],["container",""],["styleClass","p-datatable-sm p-datatable-striped",3,"value","tableStyle","paginator","rows","showJumpToPageDropdown","scrollable","currentPageReportTemplate","scrollHeight","globalFilterFields"],["table",""],["pTemplate","header"],["pTemplate","body"],[3,"modalData","handleClose"],[1,"w-15rem"],["pButton","","target","_blank","label","Ir","icon","pi pi-external-link","class","p-button-rounded p-button-sm p-button-raised w-5rem p-button-info p-button-text",3,"href","text"],[3,"label","styleClass"],[1,"flex","gap-2"],["icon","pi pi-pencil","severity","warning","label","Editar","size","small",3,"rounded","raised","onClick"],["icon","pi pi-trash","severity","danger","label","Inhabilitar","size","small",3,"rounded","raised"],["pButton","","target","_blank","label","Ir","icon","pi pi-external-link",1,"p-button-rounded","p-button-sm","p-button-raised","w-5rem","p-button-info","p-button-text",3,"href","text"],["icon","pi pi-trash","severity","danger","label","Inhabilitar","size","small",3,"rounded","raised","onClick"],["icon","pi pi-undo","severity","help","label","Habilitar","size","small",3,"rounded","raised","onClick"]],template:function(e,o){e&1&&(r(0,"app-container",0,1),g("onSearch",function(h){return o.onSearch(h)})("onOpenForm",function(){return o.onOpenForm()}),r(2,"p-table",2,3),f(4,ke,19,0,"ng-template",4)(5,Oe,23,12,"ng-template",5),n()(),r(6,"app-provider-form",6),g("handleClose",function(){return o.onHandleCose()}),n()),e&2&&(p("options",o.containerOptions),s(2),p("value",o.providers)("tableStyle",H(11,Be))("paginator",!0)("rows",20)("showJumpToPageDropdown",!0)("scrollable",!0)("currentPageReportTemplate","{currentPage} de {totalPages} p\xE1ginas ({totalRecords} registros)")("scrollHeight","calc(100vh - "+o.toolbarHeight+"px - 18.0rem)")("globalFilterFields",H(12,He)),s(4),p("modalData",o.modalData))},dependencies:[pe,le,ae,I,N,te,M,ue,de,_e]});let t=l;return t})();export{ft as ProvidersComponent};
