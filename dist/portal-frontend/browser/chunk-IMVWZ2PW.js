import{a as oe,b as le}from"./chunk-FXRGC4XZ.js";import{b as ne}from"./chunk-UEPQK3PU.js";import{a as se}from"./chunk-PXO2TRVQ.js";import{a as ae,b as re}from"./chunk-PWTX4GCB.js";import{e as $,h as J,n as X}from"./chunk-HXGQMCX4.js";import{a as q}from"./chunk-RQIDKQUN.js";import"./chunk-WTM76CTQ.js";import{d as te,e as ie}from"./chunk-AXYD25ST.js";import{e as Y,i as ee}from"./chunk-VBSZGXZN.js";import{$ as k,F as I,Fc as K,Hb as f,Ma as W,N as j,Nc as Q,O as C,Ob as D,S as O,T as B,Ta as g,Ua as d,Y as o,Za as y,_a as c,a as v,aa as N,ab as H,b,ba as E,da as x,fb as p,i as A,l as Z,m as _,ob as l,pb as h,qb as w,t as R,ta as G,u as T,wb as u,yb as U,zb as V}from"./chunk-HOTPW52P.js";var ye=["*"],z=class{_clearListeners(){for(let i of this._listeners)i.remove();this._listeners=[]}constructor(i){this._ngZone=i,this._pending=[],this._listeners=[],this._targetStream=new _(void 0)}getLazyEmitter(i){return this._targetStream.pipe(j(m=>{let e=new A(t=>{if(!m){this._pending.push({observable:e,observer:t});return}let n=m.addListener(i,a=>{this._ngZone.run(()=>t.next(a))});if(!n){t.complete();return}return this._listeners.push(n),()=>n.remove()});return e}))}setTarget(i){let m=this._targetStream.value;i!==m&&(m&&(this._clearListeners(),this._pending=[]),this._targetStream.next(i),this._pending.forEach(e=>e.observable.subscribe(e.observer)),this._pending=[])}destroy(){this._clearListeners(),this._pending=[],this._targetStream.complete()}},M={center:{lat:37.421995,lng:-122.084092},zoom:17,mapTypeId:"roadmap"},he="500px",ge="500px",L=(()=>{let i=class i{set center(e){this._center=e}set zoom(e){this._zoom=e}set options(e){this._options=e||M}constructor(e,t,n){if(this._elementRef=e,this._ngZone=t,this._eventManager=new z(o(c)),this.height=he,this.width=ge,this._options=M,this.mapInitialized=new y,this.authFailure=new y,this.boundsChanged=this._eventManager.getLazyEmitter("bounds_changed"),this.centerChanged=this._eventManager.getLazyEmitter("center_changed"),this.mapClick=this._eventManager.getLazyEmitter("click"),this.mapDblclick=this._eventManager.getLazyEmitter("dblclick"),this.mapDrag=this._eventManager.getLazyEmitter("drag"),this.mapDragend=this._eventManager.getLazyEmitter("dragend"),this.mapDragstart=this._eventManager.getLazyEmitter("dragstart"),this.headingChanged=this._eventManager.getLazyEmitter("heading_changed"),this.idle=this._eventManager.getLazyEmitter("idle"),this.maptypeidChanged=this._eventManager.getLazyEmitter("maptypeid_changed"),this.mapMousemove=this._eventManager.getLazyEmitter("mousemove"),this.mapMouseout=this._eventManager.getLazyEmitter("mouseout"),this.mapMouseover=this._eventManager.getLazyEmitter("mouseover"),this.projectionChanged=this._eventManager.getLazyEmitter("projection_changed"),this.mapRightclick=this._eventManager.getLazyEmitter("rightclick"),this.tilesloaded=this._eventManager.getLazyEmitter("tilesloaded"),this.tiltChanged=this._eventManager.getLazyEmitter("tilt_changed"),this.zoomChanged=this._eventManager.getLazyEmitter("zoom_changed"),this._isBrowser=K(n),this._isBrowser){let a=window;a.google,this._existingAuthFailureCallback=a.gm_authFailure,a.gm_authFailure=()=>{this._existingAuthFailureCallback&&this._existingAuthFailureCallback(),this.authFailure.emit()}}}ngOnChanges(e){(e.height||e.width)&&this._setSize();let t=this.googleMap;t&&(e.options&&t.setOptions(this._combineOptions()),e.center&&this._center&&t.setCenter(this._center),e.zoom&&this._zoom!=null&&t.setZoom(this._zoom),e.mapTypeId&&this.mapTypeId&&t.setMapTypeId(this.mapTypeId))}ngOnInit(){this._isBrowser&&(this._mapEl=this._elementRef.nativeElement.querySelector(".map-container"),this._setSize(),google.maps.Map?this._initialize(google.maps.Map):this._ngZone.runOutsideAngular(()=>{google.maps.importLibrary("maps").then(e=>this._initialize(e.Map))}))}_initialize(e){this._ngZone.runOutsideAngular(()=>{this.googleMap=new e(this._mapEl,this._combineOptions()),this._eventManager.setTarget(this.googleMap),this.mapInitialized.emit(this.googleMap)})}ngOnDestroy(){if(this.mapInitialized.complete(),this._eventManager.destroy(),this._isBrowser){let e=window;e.gm_authFailure=this._existingAuthFailureCallback}}fitBounds(e,t){this._assertInitialized(),this.googleMap.fitBounds(e,t)}panBy(e,t){this._assertInitialized(),this.googleMap.panBy(e,t)}panTo(e){this._assertInitialized(),this.googleMap.panTo(e)}panToBounds(e,t){this._assertInitialized(),this.googleMap.panToBounds(e,t)}getBounds(){return this._assertInitialized(),this.googleMap.getBounds()||null}getCenter(){return this._assertInitialized(),this.googleMap.getCenter()}getClickableIcons(){return this._assertInitialized(),this.googleMap.getClickableIcons()}getHeading(){return this._assertInitialized(),this.googleMap.getHeading()}getMapTypeId(){return this._assertInitialized(),this.googleMap.getMapTypeId()}getProjection(){return this._assertInitialized(),this.googleMap.getProjection()||null}getStreetView(){return this._assertInitialized(),this.googleMap.getStreetView()}getTilt(){return this._assertInitialized(),this.googleMap.getTilt()}getZoom(){return this._assertInitialized(),this.googleMap.getZoom()}get controls(){return this._assertInitialized(),this.googleMap.controls}get data(){return this._assertInitialized(),this.googleMap.data}get mapTypes(){return this._assertInitialized(),this.googleMap.mapTypes}get overlayMapTypes(){return this._assertInitialized(),this.googleMap.overlayMapTypes}_resolveMap(){return this.googleMap?Promise.resolve(this.googleMap):this.mapInitialized.pipe(I(1)).toPromise()}_setSize(){if(this._mapEl){let e=this._mapEl.style;e.height=this.height===null?"":de(this.height)||he,e.width=this.width===null?"":de(this.width)||ge}}_combineOptions(){let e=this._options||{};return b(v({},e),{center:this._center||e.center||M.center,zoom:this._zoom??e.zoom??M.zoom,mapTypeId:this.mapTypeId||e.mapTypeId||M.mapTypeId,mapId:this.mapId||e.mapId})}_assertInitialized(){this.googleMap}};i.\u0275fac=function(t){return new(t||i)(d(W),d(c),d(G))},i.\u0275cmp=k({type:i,selectors:[["google-map"]],inputs:{height:"height",width:"width",mapId:"mapId",mapTypeId:"mapTypeId",center:"center",zoom:"zoom",options:"options"},outputs:{mapInitialized:"mapInitialized",authFailure:"authFailure",boundsChanged:"boundsChanged",centerChanged:"centerChanged",mapClick:"mapClick",mapDblclick:"mapDblclick",mapDrag:"mapDrag",mapDragend:"mapDragend",mapDragstart:"mapDragstart",headingChanged:"headingChanged",idle:"idle",maptypeidChanged:"maptypeidChanged",mapMousemove:"mapMousemove",mapMouseout:"mapMouseout",mapMouseover:"mapMouseover",projectionChanged:"projectionChanged",mapRightclick:"mapRightclick",tilesloaded:"tilesloaded",tiltChanged:"tiltChanged",zoomChanged:"zoomChanged"},exportAs:["googleMap"],standalone:!0,features:[x,D],ngContentSelectors:ye,decls:2,vars:0,consts:[[1,"map-container"]],template:function(t,n){t&1&&(U(),w(0,"div",0),V(1))},encapsulation:2,changeDetection:0});let s=i;return s})(),fe=/([A-Za-z%]+)$/;function de(s){return s==null?"":fe.test(s)?s:`${s}px`}var pe=(()=>{let i=class i{set options(e){this._options.next(e||{})}set center(e){this._center.next(e)}set radius(e){this._radius.next(e)}constructor(e,t){this._map=e,this._ngZone=t,this._eventManager=new z(o(c)),this._options=new _({}),this._center=new _(void 0),this._radius=new _(void 0),this._destroyed=new Z,this.centerChanged=this._eventManager.getLazyEmitter("center_changed"),this.circleClick=this._eventManager.getLazyEmitter("click"),this.circleDblclick=this._eventManager.getLazyEmitter("dblclick"),this.circleDrag=this._eventManager.getLazyEmitter("drag"),this.circleDragend=this._eventManager.getLazyEmitter("dragend"),this.circleDragstart=this._eventManager.getLazyEmitter("dragstart"),this.circleMousedown=this._eventManager.getLazyEmitter("mousedown"),this.circleMousemove=this._eventManager.getLazyEmitter("mousemove"),this.circleMouseout=this._eventManager.getLazyEmitter("mouseout"),this.circleMouseover=this._eventManager.getLazyEmitter("mouseover"),this.circleMouseup=this._eventManager.getLazyEmitter("mouseup"),this.radiusChanged=this._eventManager.getLazyEmitter("radius_changed"),this.circleRightclick=this._eventManager.getLazyEmitter("rightclick"),this.circleInitialized=new y}ngOnInit(){this._map._isBrowser&&this._combineOptions().pipe(I(1)).subscribe(e=>{google.maps.Circle&&this._map.googleMap?this._initialize(this._map.googleMap,google.maps.Circle,e):this._ngZone.runOutsideAngular(()=>{Promise.all([this._map._resolveMap(),google.maps.importLibrary("maps")]).then(([t,n])=>{this._initialize(t,n.Circle,e)})})})}_initialize(e,t,n){this._ngZone.runOutsideAngular(()=>{this.circle=new t(n),this._assertInitialized(),this.circle.setMap(e),this._eventManager.setTarget(this.circle),this.circleInitialized.emit(this.circle),this._watchForOptionsChanges(),this._watchForCenterChanges(),this._watchForRadiusChanges()})}ngOnDestroy(){this._eventManager.destroy(),this._destroyed.next(),this._destroyed.complete(),this.circle?.setMap(null)}getBounds(){return this._assertInitialized(),this.circle.getBounds()}getCenter(){return this._assertInitialized(),this.circle.getCenter()}getDraggable(){return this._assertInitialized(),this.circle.getDraggable()}getEditable(){return this._assertInitialized(),this.circle.getEditable()}getRadius(){return this._assertInitialized(),this.circle.getRadius()}getVisible(){return this._assertInitialized(),this.circle.getVisible()}_combineOptions(){return T([this._options,this._center,this._radius]).pipe(R(([e,t,n])=>b(v({},e),{center:t||e.center,radius:n!==void 0?n:e.radius})))}_watchForOptionsChanges(){this._options.pipe(C(this._destroyed)).subscribe(e=>{this._assertInitialized(),this.circle.setOptions(e)})}_watchForCenterChanges(){this._center.pipe(C(this._destroyed)).subscribe(e=>{e&&(this._assertInitialized(),this.circle.setCenter(e))})}_watchForRadiusChanges(){this._radius.pipe(C(this._destroyed)).subscribe(e=>{e!==void 0&&(this._assertInitialized(),this.circle.setRadius(e))})}_assertInitialized(){}};i.\u0275fac=function(t){return new(t||i)(d(L),d(c))},i.\u0275dir=E({type:i,selectors:[["map-circle"]],inputs:{options:"options",center:"center",radius:"radius"},outputs:{centerChanged:"centerChanged",circleClick:"circleClick",circleDblclick:"circleDblclick",circleDrag:"circleDrag",circleDragend:"circleDragend",circleDragstart:"circleDragstart",circleMousedown:"circleMousedown",circleMousemove:"circleMousemove",circleMouseout:"circleMouseout",circleMouseover:"circleMouseover",circleMouseup:"circleMouseup",radiusChanged:"radiusChanged",circleRightclick:"circleRightclick",circleInitialized:"circleInitialized"},exportAs:["mapCircle"],standalone:!0});let s=i;return s})();var Me={position:{lat:37.421995,lng:-122.084092}},ue=(()=>{let i=class i{set title(e){this._title=e}set position(e){this._position=e}set label(e){this._label=e}set clickable(e){this._clickable=e}set options(e){this._options=e}set icon(e){this._icon=e}set visible(e){this._visible=e}constructor(e,t){this._googleMap=e,this._ngZone=t,this._eventManager=new z(o(c)),this.animationChanged=this._eventManager.getLazyEmitter("animation_changed"),this.mapClick=this._eventManager.getLazyEmitter("click"),this.clickableChanged=this._eventManager.getLazyEmitter("clickable_changed"),this.cursorChanged=this._eventManager.getLazyEmitter("cursor_changed"),this.mapDblclick=this._eventManager.getLazyEmitter("dblclick"),this.mapDrag=this._eventManager.getLazyEmitter("drag"),this.mapDragend=this._eventManager.getLazyEmitter("dragend"),this.draggableChanged=this._eventManager.getLazyEmitter("draggable_changed"),this.mapDragstart=this._eventManager.getLazyEmitter("dragstart"),this.flatChanged=this._eventManager.getLazyEmitter("flat_changed"),this.iconChanged=this._eventManager.getLazyEmitter("icon_changed"),this.mapMousedown=this._eventManager.getLazyEmitter("mousedown"),this.mapMouseout=this._eventManager.getLazyEmitter("mouseout"),this.mapMouseover=this._eventManager.getLazyEmitter("mouseover"),this.mapMouseup=this._eventManager.getLazyEmitter("mouseup"),this.positionChanged=this._eventManager.getLazyEmitter("position_changed"),this.mapRightclick=this._eventManager.getLazyEmitter("rightclick"),this.shapeChanged=this._eventManager.getLazyEmitter("shape_changed"),this.titleChanged=this._eventManager.getLazyEmitter("title_changed"),this.visibleChanged=this._eventManager.getLazyEmitter("visible_changed"),this.zindexChanged=this._eventManager.getLazyEmitter("zindex_changed"),this.markerInitialized=new y}ngOnInit(){this._googleMap._isBrowser&&(google.maps.Marker&&this._googleMap.googleMap?this._initialize(this._googleMap.googleMap,google.maps.Marker):this._ngZone.runOutsideAngular(()=>{Promise.all([this._googleMap._resolveMap(),google.maps.importLibrary("marker")]).then(([e,t])=>{this._initialize(e,t.Marker)})}))}_initialize(e,t){this._ngZone.runOutsideAngular(()=>{this.marker=new t(this._combineOptions()),this._assertInitialized(),this.marker.setMap(e),this._eventManager.setTarget(this.marker),this.markerInitialized.next(this.marker)})}ngOnChanges(e){let{marker:t,_title:n,_position:a,_label:r,_clickable:S,_icon:P,_visible:F}=this;t&&(e.options&&t.setOptions(this._combineOptions()),e.title&&n!==void 0&&t.setTitle(n),e.position&&a&&t.setPosition(a),e.label&&r!==void 0&&t.setLabel(r),e.clickable&&S!==void 0&&t.setClickable(S),e.icon&&P&&t.setIcon(P),e.visible&&F!==void 0&&t.setVisible(F))}ngOnDestroy(){this.markerInitialized.complete(),this._eventManager.destroy(),this.marker?.setMap(null)}getAnimation(){return this._assertInitialized(),this.marker.getAnimation()||null}getClickable(){return this._assertInitialized(),this.marker.getClickable()}getCursor(){return this._assertInitialized(),this.marker.getCursor()||null}getDraggable(){return this._assertInitialized(),!!this.marker.getDraggable()}getIcon(){return this._assertInitialized(),this.marker.getIcon()||null}getLabel(){return this._assertInitialized(),this.marker.getLabel()||null}getOpacity(){return this._assertInitialized(),this.marker.getOpacity()||null}getPosition(){return this._assertInitialized(),this.marker.getPosition()||null}getShape(){return this._assertInitialized(),this.marker.getShape()||null}getTitle(){return this._assertInitialized(),this.marker.getTitle()||null}getVisible(){return this._assertInitialized(),this.marker.getVisible()}getZIndex(){return this._assertInitialized(),this.marker.getZIndex()||null}getAnchor(){return this._assertInitialized(),this.marker}_resolveMarker(){return this.marker?Promise.resolve(this.marker):this.markerInitialized.pipe(I(1)).toPromise()}_combineOptions(){let e=this._options||Me;return b(v({},e),{title:this._title||e.title,position:this._position||e.position,label:this._label||e.label,clickable:this._clickable??e.clickable,map:this._googleMap.googleMap,icon:this._icon||e.icon,visible:this._visible??e.visible})}_assertInitialized(){}};i.\u0275fac=function(t){return new(t||i)(d(L),d(c))},i.\u0275dir=E({type:i,selectors:[["map-marker"]],inputs:{title:"title",position:"position",label:"label",clickable:"clickable",options:"options",icon:"icon",visible:"visible"},outputs:{animationChanged:"animationChanged",mapClick:"mapClick",clickableChanged:"clickableChanged",cursorChanged:"cursorChanged",mapDblclick:"mapDblclick",mapDrag:"mapDrag",mapDragend:"mapDragend",draggableChanged:"draggableChanged",mapDragstart:"mapDragstart",flatChanged:"flatChanged",iconChanged:"iconChanged",mapMousedown:"mapMousedown",mapMouseout:"mapMouseout",mapMouseover:"mapMouseover",mapMouseup:"mapMouseup",positionChanged:"positionChanged",mapRightclick:"mapRightclick",shapeChanged:"shapeChanged",titleChanged:"titleChanged",visibleChanged:"visibleChanged",zindexChanged:"zindexChanged",markerInitialized:"markerInitialized"},exportAs:["mapMarker"],standalone:!0,features:[x]});let s=i;return s})();var me=(()=>{let i=class i{};i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=N({type:i}),i.\u0275inj=B({});let s=i;return s})();var _e=(()=>{let i=class i{constructor(){this.END_POINT=q.API_URL+"/protected/geolocation",this.http=o(Q)}getGeolocation(){return this.http.get(this.END_POINT)}updateGeolocation(e){return this.http.put(this.END_POINT,e)}};i.\u0275fac=function(t){return new(t||i)},i.\u0275prov=O({token:i,factory:i.\u0275fac,providedIn:"root"});let s=i;return s})();var rt=(()=>{let i=class i extends se{constructor(){super(),this.center={lat:0,lng:0},this.zoom=20,this.confirmationService=o(Y),this.messageService=o(ee),this.markerOptions={draggable:!1},this.markerPosition={lat:0,lng:0},this.circleOptions={draggable:!1,fillColor:"#FFA500",strokeColor:"#FF4500",clickable:!1},this.radius=20,this.geolocationService=o(_e)}ngOnInit(){super.ngOnInit(),this.getGeolocation()}getGeolocation(){this.geolocationService.getGeolocation().subscribe(e=>{this.center={lat:e.latitude,lng:e.longitude},this.radius=e.radius,this.markerPosition={lat:e.latitude,lng:e.longitude}})}addMarker(e){e.latLng&&(this.markerPosition={lat:e.latLng.lat(),lng:e.latLng.lng()})}updateConfig(){this.confirmationService.confirm({message:"\xBFEst\xE1s seguro de que deseas actualizar la ubicaci\xF3n de la geolocalizaci\xF3n?",header:"Confirmar cambio de geolocalizaci\xF3n",icon:"pi pi-info-circle",acceptButtonStyleClass:"p-button-success",rejectButtonStyleClass:"p-button-secondary",acceptIcon:"pi pi-check mr-2",acceptLabel:"S\xED",rejectLabel:"No",accept:()=>{this.geolocationService.updateGeolocation({latitude:this.markerPosition.lat,longitude:this.markerPosition.lng,radius:this.radius}).subscribe({next:e=>{this.messageService.add({severity:"success",summary:"Geolocalizaci\xF3n actualizada",detail:"La geolocalizaci\xF3n ha sido actualizada correctamente."}),this.getGeolocation()},error:e=>{}})}})}};i.\u0275fac=function(t){return new(t||i)},i.\u0275cmp=k({type:i,selectors:[["app-geolocation"]],standalone:!0,features:[H,D],decls:22,vars:17,consts:[["styleClass","bg-teal-50"],[1,"flex","flex-column","lg:flex-row","gap-4","justify-content-center","align-items-center","w-full","h-full"],[1,"flex","flex-column","gap-4","shadow-4","p-4","border-round","w-25rem","bg-gray-900"],[1,"text-overflow-clip","text-center","text-white","bg-teal-700","p-2","border-round"],[1,"flex","flex-column","gap-2"],[1,"font-bold","text-teal-200"],["styleClass","w-full","mode","decimal",3,"readonly","ngModel","minFractionDigits","ngModelChange"],["styleClass","w-full","mode","decimal",3,"readonly","minFractionDigits","ngModel","ngModelChange"],["styleClass","w-full",3,"ngModel","min","ngModelChange"],["label","Actualizar configuraci\xF3n","styleClass","w-full","severity","info",3,"raised","rounded","click"],[1,"w-full","h-full","shadow-4","border-round","overflow-hidden"],["height","80vh","width","100%",3,"center","zoom","mapClick"],[3,"position","options"],[3,"center","radius","options"]],template:function(t,n){t&1&&(l(0,"p-card",0)(1,"div",1)(2,"div",2)(3,"h2",3),f(4," Configuraci\xF3n de geolocalizaci\xF3n "),h(),l(5,"div",4)(6,"label",5),f(7,"Latitud"),h(),l(8,"p-inputNumber",6),u("ngModelChange",function(r){return n.markerPosition.lat=r}),h()(),l(9,"div",4)(10,"label",5),f(11,"Longitud"),h(),l(12,"p-inputNumber",7),u("ngModelChange",function(r){return n.markerPosition.lng=r}),h()(),l(13,"div",4)(14,"label",5),f(15,"Radio(metros)"),h(),l(16,"p-inputNumber",8),u("ngModelChange",function(r){return n.radius=r}),h()(),l(17,"p-button",9),u("click",function(){return n.updateConfig()}),h()(),l(18,"div",10)(19,"google-map",11),u("mapClick",function(r){return n.addMarker(r)}),w(20,"map-marker",12)(21,"map-circle",13),h()()()()),t&2&&(g(8),p("readonly",!0)("ngModel",n.markerPosition.lat)("minFractionDigits",15),g(4),p("readonly",!0)("minFractionDigits",15)("ngModel",n.markerPosition.lng),g(4),p("ngModel",n.radius)("min",1),g(),p("raised",!0)("rounded",!0),g(2),p("center",n.center)("zoom",n.zoom),g(),p("position",n.markerPosition)("options",n.markerOptions),g(),p("center",n.markerPosition)("radius",n.radius)("options",n.circleOptions))},dependencies:[le,oe,re,ae,ie,te,ne,me,L,pe,ue,X,$,J],styles:["[_nghost-%COMP%]     .p-card-body, [_nghost-%COMP%]     .p-card-content{height:100%!important}"]});let s=i;return s})();export{rt as GeolocationComponent};
