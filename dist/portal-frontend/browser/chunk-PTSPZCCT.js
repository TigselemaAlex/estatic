import{a as se}from"./chunk-6YO4D3ZU.js";import{a as oe,b as le}from"./chunk-DEGAUCA6.js";import{n as ae}from"./chunk-U446ZUSE.js";import"./chunk-7XV6CRBL.js";import{a as ne,b as re}from"./chunk-LFBU7IBC.js";import"./chunk-6OSMVD66.js";import"./chunk-IAKHD2KQ.js";import"./chunk-KTZAFNHT.js";import"./chunk-L2YMTAJ4.js";import{e as W,f as K}from"./chunk-SQDM7FYD.js";import"./chunk-MUUDK5FO.js";import"./chunk-GS33KFGJ.js";import{q as te,x as ie}from"./chunk-OHCSBWXS.js";import"./chunk-APKN3PFA.js";import"./chunk-X6GEXHSG.js";import{a as X,b as Y}from"./chunk-MX4UQD2B.js";import"./chunk-X5B2VV3T.js";import"./chunk-ZTWDMVRM.js";import"./chunk-P7FDEGEE.js";import"./chunk-XSSXK7EZ.js";import{a as Z,b as ee}from"./chunk-PWTX4GCB.js";import{b as H,c as D,e as R,f as A,i as z,j as $,k as j,m as L,o as q,p as Q,q as G}from"./chunk-HXGQMCX4.js";import"./chunk-RQIDKQUN.js";import"./chunk-WTM76CTQ.js";import{d as P,e as F}from"./chunk-AXYD25ST.js";import{e as J,i as U,n as w}from"./chunk-VBSZGXZN.js";import{$ as S,Db as N,Eb as V,Fb as k,Hb as c,Ib as x,Ob as E,Pb as I,Ta as p,Wa as O,Y as h,Za as B,da as M,db as y,ea as g,fa as v,fb as s,kb as C,ob as a,pb as o,qb as f,ub as b,wb as u,xb as d}from"./chunk-HOTPW52P.js";function ue(i,l){if(i&1&&f(0,"app-error-input",6),i&2){let r=d();s("message",r.getErrorMessage("name",r.form))}}function ye(i,l){if(i&1&&f(0,"app-error-input",6),i&2){let r=d();s("message",r.getErrorMessage("price",r.form))}}function fe(i,l){if(i&1&&f(0,"app-error-input",6),i&2){let r=d();s("message",r.getErrorMessage("description",r.form))}}function _e(i,l){if(i&1){let r=b();a(0,"p-button",14),u("onClick",function(){g(r);let e=d();return v(e.handleAccept())}),o(),a(1,"p-button",15),u("onClick",function(){g(r);let e=d();return e.modalData.response=null,v(e.handleClose.emit())}),o()}i&2&&(s("raised",!0)("rounded",!0),p(),s("raised",!0)("rounded",!0))}var pe=(()=>{let l=class l{constructor(){this.fb=h(L),this.getErrorMessage=Y,this.modalData={title:"",visible:!1,data:null,response:null},this.handleClose=new B,this.form=this.fb.group({id:[""],name:["",D.required],description:[""],price:[0,[D.required,D.min(0)]]})}ngOnChanges(t){t.modalData&&(this.form.reset(),this.modalData.data&&this.form.patchValue(this.modalData.data))}handleAccept(){this.form.valid?(this.modalData.response=this.form.value,this.handleClose.emit()):Object.values(this.form.controls).forEach(t=>{t.invalid&&(t.markAsDirty(),t.updateValueAndValidity({onlySelf:!0}))})}isReadonly(){return this.modalData.data?!this.modalData.data.canBeDeleted:!1}};l.\u0275fac=function(e){return new(e||l)},l.\u0275cmp=S({type:l,selectors:[["app-penalty-type-form"]],inputs:{modalData:"modalData"},outputs:{handleClose:"handleClose"},standalone:!0,features:[M,E],decls:21,vars:12,consts:[["id","dialog","styleClass","w-10 md:w-6 lg:w-6",3,"header","visible","modal","draggable","resizable","visibleChange","onHide"],[1,"pt-4","grid","row-gap-3","h-full",3,"formGroup"],[1,"col-12","lg:col-6"],[1,"p-float-label"],["pInputText","","formControlName","name","id","name","type","text",1,"w-full",3,"readOnly"],["for","name"],[3,"message"],[1,"p-float-label","w-full"],["formControlName","price","mode","currency","currency","USD","locale","en-US","styleClass","w-full",1,"w-full",3,"min"],["for","price"],[1,"col-12"],["pInputTextarea","","formControlName","description","id","description",1,"w-full",3,"rows"],["for","description"],["pTemplate","footer"],["label","Aceptar","severity","success",3,"raised","rounded","onClick"],["label","Cancelar","severity","danger",3,"raised","rounded","onClick"]],template:function(e,n){if(e&1&&(a(0,"p-dialog",0),u("visibleChange",function(_){return n.modalData.visible=_})("onHide",function(){return n.modalData.response=null,n.handleClose.emit()}),a(1,"form",1)(2,"div",2)(3,"span",3),f(4,"input",4),a(5,"label",5),c(6,"Nombre"),o()(),y(7,ue,1,1,"app-error-input",6),o(),a(8,"div",2)(9,"span",7),f(10,"p-inputNumber",8),a(11,"label",9),c(12,"Pago mensual"),o()(),y(13,ye,1,1,"app-error-input",6),o(),a(14,"div",10)(15,"span",3),f(16,"textarea",11),a(17,"label",12),c(18,"Descripci\xF3n"),o()(),y(19,fe,1,1,"app-error-input",6),o()(),y(20,_e,2,4,"ng-template",13),o()),e&2){let m,_,T;s("header",n.modalData.title)("visible",n.modalData.visible)("modal",!0)("draggable",!1)("resizable",!1),p(),s("formGroup",n.form),p(3),s("readOnly",n.isReadonly()),p(3),C(7,(m=n.form.get("name"))!=null&&m.dirty&&((m=n.form.get("name"))!=null&&m.invalid)?7:-1),p(3),s("min",0),p(3),C(13,(_=n.form.get("price"))!=null&&_.dirty&&((_=n.form.get("price"))!=null&&_.invalid)?13:-1),p(3),s("rows",5),p(3),C(19,(T=n.form.get("description"))!=null&&T.dirty&&((T=n.form.get("description"))!=null&&T.invalid)?19:-1)}},dependencies:[K,W,w,q,z,H,R,A,$,j,F,P,ee,Z,re,ne,G,Q,X]});let i=l;return i})();var he=["container"],ge=["table"];function ve(i,l){i&1&&(a(0,"tr")(1,"th"),c(2,"Nombre"),o(),a(3,"th"),c(4,"Descripci\xF3n"),o(),a(5,"th"),c(6,"Pago"),o(),a(7,"th"),c(8,"Activo"),o(),a(9,"th",7),c(10,"Acciones"),o()())}function Ce(i,l){if(i&1){let r=b();a(0,"p-button",12),u("onClick",function(){g(r);let e=d(2).$implicit,n=d();return v(n.onDeletePenaltyType(e))}),o()}i&2&&s("rounded",!0)("raised",!0)}function be(i,l){if(i&1){let r=b();a(0,"p-button",13),u("onClick",function(){g(r);let e=d(2).$implicit,n=d();return v(n.onReactivatePenaltyType(e))}),o()}i&2&&s("rounded",!0)("raised",!0)}function Te(i,l){if(i&1&&y(0,Ce,1,2,"p-button",11)(1,be,1,2),i&2){let r=d().$implicit;C(0,r.active?0:1)}}function Se(i,l){if(i&1){let r=b();a(0,"tr")(1,"td"),c(2),o(),a(3,"td"),c(4),o(),a(5,"td"),c(6),o(),a(7,"td"),f(8,"p-chip",8),o(),a(9,"td")(10,"div",9)(11,"p-button",10),u("onClick",function(){let n=g(r).$implicit,m=d();return v(m.onOpenForm(n))}),o(),y(12,Te,2,1),o()()()}if(i&2){let r=l.$implicit,t=d();p(2),x(r.name),p(2),x(r.description),p(2),x("$ "+t.getNumberWithDigits(r.price)),p(2),s("label",r.active?"Si":"No")("styleClass",r.active?"bg-blue-100 text-blue-600 text-sm shadow-3":"bg-red-100 text-red-600 text-sm shadow-3"),p(3),s("rounded",!0)("raised",!0),p(),C(12,r.canBeDeleted?12:-1)}}var xe=()=>({"min-width":"50rem"}),Ee=()=>["name"],it=(()=>{let l=class l{constructor(){this.penaltyTypeService=h(se),this.messageService=h(U),this.confirmationService=h(J),this.cdr=h(O),this.modalData={title:"",visible:!1,data:null,response:null},this.penaltyTypes=[],this.toolbarHeight=0,this.containerOptions={dataLoading:!0,showNewButton:!0,showSearch:!0}}ngOnInit(){this.getPenaltyTypes()}ngAfterViewInit(){this.toolbarHeight=this.container.toolbar.getBlockableElement().clientHeight,this.cdr.detectChanges()}getPenaltyTypes(){this.containerOptions.dataLoading=!0,this.penaltyTypeService.findAll().subscribe({next:t=>{this.penaltyTypes=t.data,setTimeout(()=>{this.containerOptions.dataLoading=!1},300)},error:()=>{this.messageService.add({severity:"error",summary:"Error",detail:"Error al obtener los tipos de sanciones"})}})}onOpenForm(t){this.modalData={title:t?"Editar tipo de sanci\xF3n":"Nuevo tipo de sanci\xF3n",visible:!0,data:t,response:null}}onHandleClose(){if(this.modalData.response){let t=this.modalData.response.id;if(t){let e={name:this.modalData.response.name,description:this.modalData.response.description,price:this.modalData.response.price};this.penaltyTypeService.update(t,e).subscribe({next:()=>{this.messageService.add({severity:"success",summary:"\xC9xito",detail:"Tipo de sanci\xF3n actualizado correctamente"}),this.getPenaltyTypes()},error:()=>{this.messageService.add({severity:"error",summary:"Error",detail:"Error al actualizar el tipo de sanci\xF3n"})}})}else{let e={name:this.modalData.response.name,description:this.modalData.response.description,price:this.modalData.response.price};this.penaltyTypeService.save(e).subscribe({next:()=>{this.messageService.add({severity:"success",summary:"\xC9xito",detail:"Tipo de sanci\xF3n creado correctamente"}),this.getPenaltyTypes()},error:()=>{this.messageService.add({severity:"error",summary:"Error",detail:"Error al crear el tipo de sanci\xF3n"})}})}}this.reset()}onSearch(t){this.table.filterGlobal(t,"contains")}onDeletePenaltyType(t){this.confirmationService.confirm({message:`\xBFEst\xE1 seguro que desea inhabilitar el tipo de multa
                <span class="font-bold"> ${t.name}</span>
                ?`,header:"Confirmar inactivaci\xF3n",icon:"pi pi-info-circle",acceptButtonStyleClass:"p-button-danger",rejectButtonStyleClass:"p-button-secondary",acceptIcon:"pi pi-trash mr-2",acceptLabel:"S\xED",rejectLabel:"No",accept:()=>{this.penaltyTypeService.delete(t.id).subscribe({next:e=>{this.messageService.add({severity:"success",summary:"\xC9xito",detail:e.message}),this.getPenaltyTypes()},error:e=>{e.error?e.status===500?this.messageService.add({severity:"error",summary:"Error",detail:e.error}):this.messageService.add({severity:"error",summary:"Error",detail:e.error.message}):this.messageService.add({severity:"error",summary:"Error",detail:"Error al inactivar el tipo de multa"})}})}})}onReactivatePenaltyType(t){this.confirmationService.confirm({message:`\xBFEst\xE1 seguro que desea reactivar el tipo de multa
                <span class="font-bold"> ${t.name}</span>
                ?`,header:"Confirmar reactivaci\xF3n",icon:"pi pi-info-circle",acceptButtonStyleClass:"p-button-success",rejectButtonStyleClass:"p-button-secondary",acceptIcon:"pi pi-check mr-2",acceptLabel:"S\xED",rejectLabel:"No",accept:()=>{this.penaltyTypeService.activate(t.id).subscribe({next:e=>{this.messageService.add({severity:"success",summary:"\xC9xito",detail:e.message}),this.getPenaltyTypes()},error:e=>{e.error?e.status===500?this.messageService.add({severity:"error",summary:"Error",detail:e.error}):this.messageService.add({severity:"error",summary:"Error",detail:e.error.message}):this.messageService.add({severity:"error",summary:"Error",detail:"Error al reactivar el tipo de multa"})}})}})}getNumberWithDigits(t){return t.toFixed(2)}reset(){this.modalData={title:"",visible:!1,data:null,response:null}}};l.\u0275fac=function(e){return new(e||l)},l.\u0275cmp=S({type:l,selectors:[["app-penalty-type"]],viewQuery:function(e,n){if(e&1&&(N(he,5),N(ge,5)),e&2){let m;V(m=k())&&(n.container=m.first),V(m=k())&&(n.table=m.first)}},standalone:!0,features:[E],decls:7,vars:13,consts:[[1,"block","mt-2",3,"options","onSearch","onOpenForm"],["container",""],["styleClass","p-datatable-sm p-datatable-striped",3,"value","tableStyle","paginator","rows","showJumpToPageDropdown","scrollable","currentPageReportTemplate","scrollHeight","globalFilterFields"],["table",""],["pTemplate","header"],["pTemplate","body"],[3,"modalData","handleClose"],[1,"w-8rem"],[3,"label","styleClass"],[1,"flex","gap-2"],["icon","pi pi-pencil","severity","warning","label","Editar","size","small",3,"rounded","raised","onClick"],["icon","pi pi-trash","severity","danger","label","Inhabilitar","size","small",3,"rounded","raised"],["icon","pi pi-trash","severity","danger","label","Inhabilitar","size","small",3,"rounded","raised","onClick"],["icon","pi pi-undo","severity","help","label","Habilitar","size","small",3,"rounded","raised","onClick"]],template:function(e,n){e&1&&(a(0,"app-container",0,1),u("onSearch",function(_){return n.onSearch(_)})("onOpenForm",function(){return n.onOpenForm()}),a(2,"p-table",2,3),y(4,ve,11,0,"ng-template",4)(5,Se,13,8,"ng-template",5),o()(),a(6,"app-penalty-type-form",6),u("handleClose",function(){return n.onHandleClose()}),o()),e&2&&(s("options",n.containerOptions),p(2),s("value",n.penaltyTypes)("tableStyle",I(11,xe))("paginator",!0)("rows",20)("showJumpToPageDropdown",!0)("scrollable",!0)("currentPageReportTemplate","{currentPage} de {totalPages} p\xE1ginas ({totalRecords} registros)")("scrollHeight","calc(100vh - "+n.toolbarHeight+"px - 18.0rem)")("globalFilterFields",I(12,Ee)),p(4),s("modalData",n.modalData))},dependencies:[ae,ie,te,w,F,P,le,oe,pe]});let i=l;return i})();export{it as PenaltyTypeComponent};
